import{j as e,c as k,u as v,l as $,d as J,s as B,a as E,i as F}from"./utils.bLvbV6bL.js";import{r as i}from"./index.sXsv9c-e.js";import{T as R,a as _,b as m,c as u,f as M}from"./common.u-9orcM8.js";import{b as A,_ as P}from"./index.zSBU31wW.js";import{c as U,B as c}from"./button.Zbz0OamP.js";import{D as V,a as X,b as q,c as H,d as I}from"./dialog.JrXWYe8i.js";import{E as W}from"./ExternalLink.I0nfYBUQ.js";const z=i.forwardRef((n,s)=>i.createElement(A.label,P({},n,{ref:s,onMouseDown:t=>{var o;(o=n.onMouseDown)===null||o===void 0||o.call(n,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault()}}))),L=z,G=U("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=i.forwardRef(({className:n,...s},t)=>e.jsx(L,{ref:t,className:k(G(),n),...s}));d.displayName=L.displayName;const C=i.forwardRef(({className:n,...s},t)=>e.jsx("textarea",{className:k("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",n),ref:t,...s}));C.displayName="Textarea";function ne(n){const{trxJSON:s,operationName:t,username:o,usrChain:r,userID:N,dismissCallback:y,headerText:T}=n,{t:a,i18n:K}=v($.get(),{i18n:F}),[p,x]=i.useState("object"),[l,w]=i.useState();i.useEffect(()=>{async function b(){const f=await fetch(`http://localhost:8080/api/deeplink/${r}/${t}`,{method:"POST",body:JSON.stringify(s)});if(!f.ok){console.log("Failed to fetch deeplink");return}const g=await f.json();if(g&&g.result){const O=J(B(g.result,!0)),j=JSON.parse(E(O));j.generatedDeepLink&&w(j.generatedDeepLink)}}r&&t&&s&&b()},[r,t,s]);const[D,h]=i.useState(!1),S=()=>{D||(h(!0),setTimeout(()=>{h(!1)},1e4))};return e.jsx(V,{open:!0,onOpenChange:b=>{y(b)},children:e.jsxs(X,{className:"sm:max-w-[800px] bg-white",children:[e.jsxs(q,{children:[e.jsx(H,{children:l?e.jsx(e.Fragment,{children:T}):a("DeepLinkDialog:dialogContent.generatingDeeplink")}),e.jsxs(I,{children:[a("DeepLinkDialog:dialogContent.withAccount",{username:o,userID:N}),l?e.jsxs(e.Fragment,{children:[e.jsx("br",{}),a("DeepLinkDialog:dialogContent.readyToBroadcast"),e.jsx("br",{}),a("DeepLinkDialog:dialogContent.chooseMethod")," ",e.jsx(W,{classnamecontents:"text-blue-500",type:"text",text:a("DeepLinkDialog:dialogContent.beetWallet"),hyperlink:"https://github.com/bitshares/beet"})]}):null]})]}),p?e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"mt-3"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:e.jsxs(R,{defaultValue:"object",className:"w-full",children:[e.jsxs(_,{className:"grid w-full grid-cols-3 gap-2",children:[e.jsx(m,{value:"object",onClick:()=>x("object"),children:a("DeepLinkDialog:tabs.viewTRXObject")},"TRXTab"),e.jsx(m,{value:"deeplink",onClick:()=>x("deeplink"),children:a("DeepLinkDialog:tabs.rawDeeplink")},"DLTab"),e.jsx(m,{value:"localJSON",onClick:()=>x("localJSON"),children:a("DeepLinkDialog:tabs.localJSONFile")},"JSONTab")]},`${p||"loading"}_TabList`),e.jsxs(u,{value:"object",children:[e.jsxs("div",{className:"grid w-full gap-1.5 mb-3",children:[e.jsx(d,{className:"text-left",children:a("DeepLinkDialog:tabsContent.transactionObjectJSON")}),e.jsx("span",{className:"text-left text-sm",children:a("DeepLinkDialog:tabsContent.operationType",{operationName:t})}),e.jsx(C,{value:JSON.stringify(s,null,4),className:"min-h-[250px]",id:"trxJSON",readOnly:!0})]}),e.jsx(c,{onClick:()=>{M(JSON.stringify(s,null,4))},children:a("DeepLinkDialog:tabsContent.copyOperationJSON")})]}),e.jsxs(u,{value:"deeplink",children:[e.jsx(d,{className:"text-left",children:a("DeepLinkDialog:tabsContent.usingDeeplink")}),e.jsxs("ol",{className:"ml-4",children:[e.jsx("li",{type:"1",children:a("DeepLinkDialog:tabsContent.step1")}),e.jsx("li",{type:"1",children:a("DeepLinkDialog:tabsContent.step2",{operationName:t})}),e.jsx("li",{type:"1",children:a("DeepLinkDialog:tabsContent.step3")}),e.jsx("li",{type:"1",children:a("DeepLinkDialog:tabsContent.step4")}),e.jsx("li",{type:"1",children:a("DeepLinkDialog:tabsContent.step5")})]}),l?e.jsx("a",{href:`rawbeet://api?chain=${r==="bitshares"?"BTS":"BTS_TEST"}&request=${l}`,children:e.jsx(c,{className:"mt-4",children:a("DeepLinkDialog:tabsContent.triggerRawBeet")})}):null]}),e.jsxs(u,{value:"localJSON",children:[e.jsx(d,{className:"text-left",children:a("DeepLinkDialog:tabsContent.viaLocalFile")}),e.jsxs("ol",{className:"ml-4",children:[e.jsx("li",{type:"1",children:a("DeepLinkDialog:tabsContent.step1Local")}),e.jsx("li",{type:"1",children:a("DeepLinkDialog:tabsContent.step2Local",{operationName:t})}),e.jsx("li",{type:"1",children:a("DeepLinkDialog:tabsContent.step3Local")}),e.jsx("li",{type:"1",children:a("DeepLinkDialog:tabsContent.step4Local")}),e.jsx("li",{type:"1",children:a("DeepLinkDialog:tabsContent.step5Local")})]}),l&&D?e.jsx(c,{className:"mt-4",variant:"outline",disabled:!0,children:a("DeepLinkDialog:tabsContent.downloading")}):null,l&&!D?e.jsx("a",{href:`data:text/json;charset=utf-8,${l}`,download:`${t}.json`,target:"_blank",rel:"noreferrer",onClick:S,children:e.jsx(c,{className:"mt-4",children:a("DeepLinkDialog:tabsContent.downloadBeetOperationJSON")})}):null]})]},l?"deeplinkLoaded":"loading")})]}):null]})})}export{ne as D,d as L};
