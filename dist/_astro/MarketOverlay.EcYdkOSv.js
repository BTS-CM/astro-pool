import{I as ge,J as ye,u as e,K as be,v as As,a2 as Bs,P as fe,Q as Ss,S as Cs,T as Ts,U as Ms,V as Ls,W as _s,O as Ge}from"./button.GNxhEuHR.js";import{r as i}from"./index.ebYJtNMn.js";import{C as J,b as W,c as K,d as Y,m as ae,I as Q,H as Ie,a as qe,e as Re,i as ze,j as Qe,w as ts,p as Ps,$ as is,n as ns,o as cs,k as ds,l as os,u as Fs,f as $s}from"./CurrentUser.-qj3GEkM.js";import{B as E}from"./badge.4MPjMHVy.js";import{S as D,M as ms}from"./MarketAssetCard.oQxGviqh.js";import{e as us,t as He,b as Ue,h as ke,f as ws,i as Ds,T as Se,a as Ce,c as S,d as le}from"./common.8EOjqkfr.js";import{u as Hs,F as hs,a as ne,b as ce,c as oe,f as de,d as ve,e as je}from"./form.K-qcZ4h1.js";import{S as Ze,a as es,b as ss,c as Es,d as De}from"./select.kQzBLqB8.js";import{f as Vs,C as Us}from"./calendar.UQ8kNnfN.js";import{P as Pe,a as Fe,b as $e}from"./popover.6F0wszCH.js";import{L as Oe,D as Is}from"./DeepLinkDialog.ItBmpkBJ.js";import{a as Je,C as xs,S as ps}from"./checkbox.yzTRTfh6.js";import{F as qs}from"./index.esm.awlXaKq2.js";import{A as js}from"./AssetDropDownCard.EmjLsX8Q.js";import{S as We}from"./scroll-area.7HKeB6rs.js";import{E as Ee}from"./ExternalLink.dfYCZp39.js";import{P as Rs}from"./PoolDialogs.AI2UUhMB.js";import{b as zs,d as Qs}from"./Market.vR_xYB9H.js";import{f as bs,d as gs,e as ys}from"./Assets.V2CieyEL.js";import"./CardRow.sQhBpZ4E.js";import"./index.J3aFWESX.js";import"./index.JRs5YgGT.js";import"./index.f2GGseSc.js";import"./fuse.aCsZfKX4.js";function fs(s){const{usr:l,thisAssetA:a,thisAssetB:r,assetAData:t,assetBData:n,orderType:d,marketSearch:c,usrBalances:o,fee:m,invertedMarket:x}=s,{t:h,i18n:u}=ge(ye.get(),{i18n:fe}),{buyOrders:p,sellOrders:j}=s,[b,y]=i.useState(0),[g,N]=i.useState(0),[v,f]=i.useState(0),k=i.useMemo((()=>{let e=0;if(b&&g&&v){if("buy"===d&&t&&t.market_fee_percent&&t.market_fee_percent>0)return e=parseFloat(b)*(t.market_fee_percent/100),e.toFixed(t.precision);if("sell"===d&&n&&n.market_fee_percent&&n.market_fee_percent>0)return e=parseFloat(v)*(n.market_fee_percent/100),e.toFixed(n.precision)}return e}),[b,g,v,d,t,n]),[O,S]=i.useState("1hr"),[C,D]=i.useState((()=>{const e=new Date;return new Date(e.getTime()+36e5)})),[M,T]=i.useState(new Date(Date.now()+6048e5));i.useEffect((()=>{"specific"===O&&M&&D(M)}),[O,M]);const L=Hs({defaultValues:{account:""}}),[w,_]=i.useState(!1);function A(e,s){const l=e.id,a=s.find((e=>e.asset_id===l));return a?ke(a.amount,e.precision).toLocaleString(void 0,{minimumFractionDigits:e.precision}):0}const B=i.useMemo((()=>t&&o?A(t,o):0),[t,o]),P=i.useMemo((()=>n&&o?A(n,o):0),[n,o]),[F,$]=i.useState(!1),[H,q]=i.useState(1),[V,I]=i.useState(100),[z,R]=i.useState(1e6),[U,G]=i.useState(!1);i.useEffect((()=>{c&&c.length&&window.location.search&&async function(){const e=new URLSearchParams(window.location.search),s=Object.fromEntries(e.entries()),l=s.amount,a=s.price,r=s.oso,i=s.spreadPercent,d=s.sizePercent,c=s.expirationSeconds,o=s.repeat;let m=b,x=g,h=v,u=F,p=H,j=V,y=z,N=U;const f=ke(1,t.precision),k=ke(1,n.precision);if(l){const e=parseFloat(l);e&&(m=e>=f?e:f)}if(a){const e=parseFloat(a);e&&(x=e>=k?e:k)}if(m&&x){const e=parseFloat((m*x).toFixed(n.precision));h=e>=k?e:k}if(r){const e="true"===r;e&&(u=e)}if(i){const e=parseFloat(i);e&&e>=0&&e<=100?p=parseFloat(e.toFixed(3)):e&&e>100?p=100:e&&e<0&&(p=0)}if(d){const e=parseFloat(d);e&&e>=0&&e<=100?j=parseFloat(e.toFixed(3)):e&&e>100?j=100:e&&e<0&&(j=0)}if(c){const e=parseFloat(c);e&&(y=e)}if(o){const e="true"===o;e&&(N=e)}return{finalAmount:m,finalPrice:x,finalTotal:h,finalOSO:u,finalSpreadPercent:p,finalSizePercent:j,finalExpirationSeconds:y,finalRepeat:N}}().then((({finalAmount:e,finalPrice:s,finalTotal:l,finalOSO:i,finalSpreadPercent:t,finalSizePercent:n,finalExpirationSeconds:c,finalRepeat:o})=>{e!==b&&y(e),s!==g&&N(s),l!==v&&f(l),i!==F&&$(i),t!==H&&q(t),n!==V&&I(n),c!==z&&R(c),o!==U&&G(o);let m=`?market=${a}_${r}&type=${d}&price=${s}&amount=${e}`;i&&(m+=`&oso=${i}&spreadPercent=${t}&sizePercent=${n}&expirationSeconds=${c}&repeat=${o}`),window.history.replaceState({},"",m)}))}),[]);const[Z,X]=i.useState(0);i.useEffect((()=>{if(Z>0){let e=`?market=${a}_${r}&type=${d}&price=${g}&amount=${b}`;F&&(e+=`&oso=${F}&spreadPercent=${H}&sizePercent=${V}&expirationSeconds=${z}&repeat=${U}`),window.history.replaceState({},"",e)}}),[b,g,v,F,H,V,z,U]);const ee=i.useCallback(us(((e,s)=>{/^[0-9]*\.?[0-9]*$/.test(e)&&e>=0&&e<=100&&(q(e),X(Z+1))}),25),[]),se=i.useCallback(us(((e,s)=>{/^[0-9]*\.?[0-9]*$/.test(e)&&e>=0&&e<=100&&(I(e),X(Z+1))}),25),[]);return e.jsxs(J,{children:[e.jsxs(W,{className:"pb-2",children:[e.jsx(K,{children:h("buy"===d?"LimitOrderCard:buyingWith":"LimitOrderCard:sellingFor",{assetA:a,assetB:r})}),e.jsx(Y,{children:h("LimitOrderCard:createLimitOrder")})]}),e.jsxs(ae,{children:[a&&r&&c&&t&&n?e.jsx(hs,{...L,children:e.jsxs("form",{onSubmit:e=>{_(!0),e.preventDefault()},children:[e.jsx(ne,{control:L.control,name:"priceAmount",render:({field:s})=>e.jsxs(ce,{className:"mt-4 text-xs",children:[e.jsx(oe,{children:h("LimitOrderCard:priceAmount.label")}),e.jsx(de,{children:h("LimitOrderCard:priceAmount.description",{assetA:a,assetB:r})}),e.jsx(ve,{children:e.jsxs("span",{className:"grid grid-cols-12",children:[e.jsx("span",{className:"col-span-9",children:e.jsx(Q,{label:"Price",placeholder:g,disabled:!0,readOnly:!0})}),e.jsx("span",{className:"col-span-3 ml-3 text-center",children:e.jsxs(Pe,{children:[e.jsx(Fe,{children:e.jsx("span",{className:"inline-block border border-grey rounded pl-4 pb-1 pr-4 text-lg",children:e.jsx(Oe,{children:h("LimitOrderCard:editLabel")})})}),e.jsxs($e,{children:[e.jsx(Oe,{children:h("LimitOrderCard:priceAmount.provideNewLabel")})," ",e.jsx(Q,{placeholder:g,className:"mb-2 mt-1",onChange:e=>{const s=e.target.value;if(s&&s.length&&/^[0-9,]*\.?[0-9]*$/.test(s)){const e=parseFloat(s.replaceAll(",",""));e&&(N(e.toFixed("buy"===d?n.precision:t.precision)),b&&f((e*b).toFixed("buy"===d?n.precision:t.precision)),X(Z+1))}}}),"buy"===d&&!j||j&&!j.length||"sell"===d&&!p||p&&!p.length?e.jsx(E,{disabled:!0,children:h("buy"===d?"LimitOrderCard:priceAmount.useLowestAsk":"LimitOrderCard:priceAmount.useHighestBid")}):e.jsx("span",{variant:"link",onClick:e=>{let s;e.preventDefault(),"buy"===d&&j&&j.length>0?s=He(parseFloat(j[0].price),n.precision):"sell"===d&&p&&p.length>0&&(s=He(parseFloat(p[0].price),n.precision)),s&&(N(parseFloat(s).toFixed(n.precision)),b&&f((parseFloat(s)*parseFloat(b)).toFixed(n.precision)),X(Z+1))},children:e.jsx(E,{children:h("buy"===d?"LimitOrderCard:priceAmount.useLowestAsk":"LimitOrderCard:priceAmount.useHighestBid")})})]})]})})]})}),e.jsx(je,{})]})}),e.jsx(ne,{control:L.control,name:"sellAmount",render:({field:s})=>e.jsxs(ce,{className:"mt-4 text-xs",children:[e.jsx(oe,{children:h("LimitOrderCard:sellAmount.label")}),e.jsx(de,{children:h("buy"===d?"LimitOrderCard:sellAmount.buyDescription":"LimitOrderCard:sellAmount.sellDescription",{asset:a})}),e.jsx(ve,{children:e.jsxs("span",{className:"grid grid-cols-12",children:[e.jsx("span",{className:"col-span-9",children:e.jsx(Q,{label:"Amount",placeholder:b,disabled:!0,readOnly:!0})}),e.jsx("span",{className:"col-span-3 ml-3 text-center",children:e.jsxs(Pe,{children:[e.jsx(Fe,{children:e.jsx("span",{className:"inline-block border border-grey rounded pl-4 pb-1 pr-4 text-lg",children:e.jsx(Oe,{children:h("LimitOrderCard:editLabel")})})}),e.jsxs($e,{children:[e.jsx(Oe,{children:h("LimitOrderCard:sellAmount.provideNewLabel")})," ",e.jsx(Q,{placeholder:b,className:"mb-2 mt-1",onChange:e=>{const s=e.target.value;if(s&&s.length&&/^[0-9,]*\.?[0-9]*$/.test(s)){const e=parseFloat(s.replaceAll(",",""));e&&(y(e.toFixed(t.precision)),g&&f((e*g).toFixed(n.precision)),X(Z+1))}}}),"sell"===d&&B?e.jsx(E,{onClick:()=>{let e=parseFloat(B.replaceAll(",",""));e&&(y(e.toFixed(t.precision)),g&&f((e*g).toFixed(n.precision)),X(Z+1))},children:h("LimitOrderCard:useBalance")}):null]})]})})]})})]})}),e.jsx(ne,{control:L.control,name:"sellTotal",render:({field:s})=>e.jsxs(ce,{className:"mt-4 text-xs",children:[e.jsx(oe,{children:h("LimitOrderCard:sellTotal.label")}),e.jsx(de,{children:h("buy"===d?"LimitOrderCard:sellTotal.buyDescription":"LimitOrderCard:sellTotal.sellDescription",{asset:r})}),e.jsx(ve,{children:e.jsxs("span",{className:"grid grid-cols-12",children:[e.jsx("span",{className:"col-span-9",children:e.jsx(Q,{label:"Total",placeholder:v,disabled:!0,readOnly:!0})}),e.jsx("span",{className:"col-span-3 ml-3 text-center",children:e.jsxs(Pe,{children:[e.jsx(Fe,{children:e.jsx("span",{className:"inline-block border border-grey rounded pl-4 pb-1 pr-4 text-lg",children:e.jsx(Oe,{children:h("LimitOrderCard:editLabel")})})}),e.jsxs($e,{children:[e.jsx(Oe,{children:h("LimitOrderCard:sellTotal.provideNewLabel")}),e.jsx(Q,{placeholder:v,className:"mb-2 mt-1",onChange:e=>{const s=e.target.value;if(s&&s.length&&/^[0-9,]*\.?[0-9]*$/.test(s)){const e=parseFloat(s.replaceAll(",",""));e&&(f(e.toFixed(n.precision)),g&&y((e/g).toFixed(t.precision)),X(Z+1))}}}),"buy"===d&&P?e.jsx(E,{onClick:()=>{let e=parseFloat(P.replaceAll(",",""));e&&(f(e.toFixed(n.precision)),g&&y((e/g).toFixed(t.precision)),X(Z+1))},children:h("LimitOrderCard:useBalance")}):null]})]})})]})}),b&&g&&P&&parseFloat(P.replaceAll(",",""))<parseFloat(v)?e.jsx(je,{children:h("LimitOrderCard:sellTotal.requireMore",{requiredAmount:v-parseFloat(P.replaceAll(",","")).toFixed(n.precision),asset:r})}):null]})}),e.jsx(ne,{control:L.control,name:"expiry",render:({field:s})=>e.jsxs(ce,{children:[e.jsx(oe,{children:h("LimitOrderCard:expiry.label")}),e.jsx(ve,{onValueChange:e=>{S(e);const s=36e5,l=24*s;if("specific"!==e&&"fkill"!==e){const a=new Date;let r;if("1hr"===e)r=new Date(a.getTime()+s);else if("12hr"===e){const e=12*s;r=new Date(a.getTime()+e)}else if("24hr"===e){const e=l;r=new Date(a.getTime()+e)}else if("7d"===e){const e=7*l;r=new Date(a.getTime()+e)}else if("30d"===e){const e=30*l;r=new Date(a.getTime()+e)}r&&T(r),D(e)}else if("fkill"===e){const e=new Date;D(new Date(e.getTime()+l))}else"specific"===e&&D();X(Z+1)},children:e.jsxs(Ze,{children:[e.jsx(es,{className:"mb-3",children:e.jsx(ss,{placeholder:"1hr"})}),e.jsxs(Es,{className:"bg-white",children:[e.jsx(De,{value:"1hr",children:h("LimitOrderCard:expiry.1hr")}),e.jsx(De,{value:"12hr",children:h("LimitOrderCard:expiry.12hr")}),e.jsx(De,{value:"24hr",children:h("LimitOrderCard:expiry.24hr")}),e.jsx(De,{value:"7d",children:h("LimitOrderCard:expiry.7d")}),e.jsx(De,{value:"30d",children:h("LimitOrderCard:expiry.30d")}),e.jsx(De,{value:"specific",children:h("LimitOrderCard:expiry.specific")}),e.jsx(De,{value:"fkill",children:h("LimitOrderCard:expiry.fkill")})]})]})}),e.jsxs(de,{children:["specific"===O?e.jsxs(Pe,{children:[e.jsx(Fe,{asChild:!0,children:e.jsxs(be,{variant:"outline",className:As("w-[240px] justify-start text-left font-normal",!M&&"text-muted-foreground"),children:[e.jsx(Bs,{className:"mr-2 h-4 w-4"}),M?Vs(M,"PPP"):e.jsx("span",{children:h("LimitOrderCard:expiry.pickDate")})]})}),e.jsx($e,{className:"w-auto p-0",align:"start",children:e.jsx(Us,{mode:"single",selected:M,onSelect:e=>{new Date(e)<new Date?T(new Date(Date.now()+864e5)):T(e)},initialFocus:!0})})]}):null,"fkill"===O?h("LimitOrderCard:expiry.fkillDescription"):null,"specific"!==O&&"fkill"!==O?h("LimitOrderCard:expiry.generalDescription",{expiryType:O}):null]}),e.jsx(je,{})]})}),e.jsx(Je,{className:"mb-2 mt-2"}),e.jsx(ne,{control:L.control,name:"osoValue",render:({field:s})=>e.jsxs(ce,{children:[e.jsx(ve,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(xs,{id:"terms1",checked:F,onClick:()=>{$(!F),X(Z+1)}}),e.jsx("label",{htmlFor:"terms1",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:h(F?"LimitOrderCard:osoValue.enabled":"LimitOrderCard:osoValue.enable")})]})}),F?e.jsx(de,{children:h("LimitOrderCard:osoValue.description")}):null]})}),F?e.jsxs(e.Fragment,{children:[e.jsx(ne,{control:L.control,name:"osoSpread",render:({field:s})=>e.jsxs(ce,{className:"mt-2 text-xs",children:[e.jsx(oe,{className:"text-sm",children:h("LimitOrderCard:osoEnabled.spreadPercentLabel")}),e.jsx(de,{children:h("LimitOrderCard:osoEnabled.spreadPercentDescription")}),e.jsx(ve,{children:e.jsxs("span",{className:"grid grid-cols-12",children:[e.jsxs("span",{className:"col-span-9",children:[e.jsx(Q,{label:h("LimitOrderCard:osoEnabled.spreadPercentLabel"),placeholder:H,disabled:!0,readOnly:!0}),e.jsx(ps,{className:"mt-3",defaultValue:[H],max:100,min:1,step:.01,onValueChange:e=>{ee(e[0])}})]}),e.jsx("span",{className:"col-span-3 ml-3 text-center",children:e.jsxs(Pe,{children:[e.jsx(Fe,{children:e.jsx("span",{onClick:()=>{event.preventDefault()},className:"inline-block border border-grey rounded pl-4 pb-1 pr-4 text-lg",children:e.jsx(Oe,{children:h("LimitOrderCard:editLabel")})})}),e.jsxs($e,{children:[e.jsx(Oe,{children:h("LimitOrderCard:osoEnabled.provideNewSpreadPercent")}),e.jsx(Q,{placeholder:H,className:"mb-2 mt-1",onChange:e=>{const s=e.target.value;s&&s.length&&/^[0-9]*\.?[0-9]*$/.test(s)&&s>=1&&s<=100&&(q(s),X(Z+1))}})]})]})})]})}),e.jsx(je,{})]})}),e.jsx(ne,{control:L.control,name:"osoSize",render:({field:s})=>e.jsxs(ce,{className:"mt-4 text-xs",children:[e.jsx(oe,{className:"text-sm",children:h("LimitOrderCard:osoSize.sizePercentLabel")}),e.jsx(de,{children:h("LimitOrderCard:osoSize.sizePercentDescription")}),e.jsx(ve,{children:e.jsxs("span",{className:"grid grid-cols-12",children:[e.jsxs("span",{className:"col-span-9",children:[e.jsx(Q,{label:h("LimitOrderCard:osoSize.sizePercentLabel"),placeholder:V,disabled:!0,readOnly:!0}),e.jsx(ps,{className:"mt-3",defaultValue:[V],max:100,min:0,step:.01,onValueChange:e=>{se(e[0])}})]}),e.jsx("span",{className:"col-span-3 ml-3 text-center",children:e.jsxs(Pe,{children:[e.jsx(Fe,{children:e.jsx("span",{onClick:()=>{event.preventDefault()},className:"inline-block border border-grey rounded pl-4 pb-1 pr-4 text-lg",children:e.jsx(Oe,{children:h("LimitOrderCard:editLabel")})})}),e.jsxs($e,{children:[e.jsx(Oe,{children:h("LimitOrderCard:osoSize.provideNewSizePercent")}),e.jsx(Q,{placeholder:V,className:"mb-2 mt-1",onChange:e=>{const s=e.target.value;s&&s.length&&/^[0-9]*\.?[0-9]*$/.test(s)&&s>=0&&s<=100&&(I(s),X(Z+1))}})]})]})})]})}),e.jsx(je,{})]})}),e.jsx(ne,{control:L.control,name:"repeatValue",render:({field:s})=>e.jsxs(ce,{className:"mt-4 text-xs",children:[e.jsx(oe,{className:"text-sm",children:h("LimitOrderCard:repeatValue.label")}),e.jsx(de,{children:h("LimitOrderCard:repeatValue.description")}),e.jsx(ve,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(xs,{id:"terms2",checked:U,onClick:()=>{G(!U),X(Z+1)}}),e.jsx("label",{htmlFor:"terms2",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:h(U?"LimitOrderCard:repeatValue.enabled":"LimitOrderCard:repeatValue.disabled")})]})}),e.jsx(je,{})]})})]}):null,e.jsx(Je,{className:"mt-3"}),e.jsx(ne,{control:L.control,disabled:!0,name:"fee",render:({field:s})=>e.jsxs(ce,{children:[e.jsx(oe,{children:h("LimitOrderCard:fee.label")}),e.jsx(de,{children:h("LimitOrderCard:fee.description")}),e.jsx(ve,{children:e.jsx(Q,{disabled:!0,label:h("LimitOrderCard:fee.label"),value:`${m} BTS`,placeholder:1})}),"fkill"===O||l.id===l.referrer?e.jsxs(je,{children:["fkill"===O?h("LimitOrderCard:fee.unfilledRebate",{fee:m}):null,e.jsx("br",{}),l.id===l.referrer?h("LimitOrderCard:fee.ltmRebate",{rebate:.8*m}):null]}):null]})}),"buy"===d&&t&&t.market_fee_percent&&t.market_fee_percent>0?e.jsx(ne,{control:L.control,disabled:!0,name:"marketFees",render:({field:s})=>e.jsxs(ce,{children:[e.jsx(oe,{children:h("LimitOrderCard:marketFees.label")}),e.jsx(ve,{children:e.jsx(Q,{disabled:!0,value:`${k} ${t.symbol}`,placeholder:`${k} ${t.symbol}`})}),e.jsx(de,{children:h("LimitOrderCard:marketFees.description")})]})}):null,"sell"===d&&n&&n.market_fee_percent&&n.market_fee_percent>0?e.jsx(ne,{control:L.control,disabled:!0,name:"marketFees",render:({field:s})=>e.jsxs(ce,{children:[e.jsx(oe,{children:h("LimitOrderCard:marketFees.label")}),e.jsx(ve,{children:e.jsx(Q,{disabled:!0,value:`${k} ${n.symbol}`,placeholder:`${k} ${n.symbol}`})}),e.jsx(je,{}),e.jsx(de,{children:h("LimitOrderCard:marketFees.description")})]})}):null,b&&g&&C?e.jsx(be,{className:"mt-7 mb-1",variant:"outline",type:"submit",children:h("LimitOrderCard:submit")}):e.jsx(be,{className:"mt-7 mb-1",variant:"outline",disabled:!0,type:"submit",children:h("LimitOrderCard:submit")})]})}):e.jsx(hs,{...L,children:e.jsxs("form",{children:[e.jsx(ne,{control:L.control,name:"sellPrice",render:({field:s})=>e.jsxs(ce,{children:[e.jsx(oe,{children:e.jsxs("div",{className:"grid grid-cols-2 mt-3",children:[e.jsx("div",{className:"mt-1",children:h("LimitOrderCard:sellPrice.label")}),e.jsx("div",{className:"text-gray-500 text-right",children:e.jsx("span",{variant:"link",children:e.jsx(E,{children:h("LimitOrderCard:sellPrice.useLowestAsk")})})})]})}),e.jsx(Q,{disabled:!0,className:"mb-3"}),e.jsx(de,{children:h("LimitOrderCard:sellPrice.description")}),e.jsx(je,{})]})}),e.jsx(ne,{control:L.control,name:"sellAmount",render:({field:s})=>e.jsxs(ce,{children:[e.jsx(oe,{children:e.jsxs("div",{className:"grid grid-cols-2 mt-3",children:[e.jsx("div",{className:"mt-1",children:h("LimitOrderCard:sellAmount2.label")}),e.jsx("div",{className:"text-gray-500 text-right",children:"sell"===d&&B?e.jsx(E,{children:h("LimitOrderCard:useBalance")}):null})]})}),e.jsx(de,{children:h("buy"===d?"LimitOrderCard:sellAmount2.buyDescription":"LimitOrderCard:sellAmount2.sellDescription")}),e.jsx(Q,{disabled:!0,className:"mb-3"}),e.jsx(je,{})]})}),e.jsx(ne,{control:L.control,name:"sellTotal",render:({field:s})=>e.jsxs(ce,{children:[e.jsx(oe,{children:e.jsxs("div",{className:"grid grid-cols-2 mt-3",children:[e.jsx("div",{className:"mt-1",children:h("LimitOrderCard:sellTotal2.label")}),e.jsx("div",{className:"text-gray-500 text-right",children:"buy"===d&&P?e.jsx(E,{children:h("LimitOrderCard:useBalance")}):null})]})}),e.jsx(de,{children:h("buy"===d?"LimitOrderCard:sellTotal2.buyDescription":"LimitOrderCard:sellTotal2.sellDescription")}),e.jsx(Q,{disabled:!0,className:"mb-3"})]})}),e.jsx(ne,{control:L.control,name:"expiry",render:({field:s})=>e.jsxs(ce,{children:[e.jsx(oe,{children:h("LimitOrderCard:expiry2.label")}),e.jsx(de,{children:h("LimitOrderCard:expiry2.description")}),e.jsx(Ze,{disabled:!0,children:e.jsx(es,{className:"mb-3",children:e.jsx(ss,{placeholder:"1hr"})})}),e.jsx(je,{})]})}),e.jsx(ne,{control:L.control,disabled:!0,name:"fee",render:({field:s})=>e.jsxs(ce,{children:[e.jsx(oe,{children:h("LimitOrderCard:fee.label")}),e.jsx(Q,{disabled:!0,label:h("LimitOrderCard:fee.label")}),e.jsx(de,{children:h("LimitOrderCard:fee.description")}),"fkill"===O||l.id===l.referrer?e.jsxs(je,{children:["fkill"===O?h("LimitOrderCard:fee.unfilledRebate",{rebate:.4826}):null,l.id===l.referrer?h("LimitOrderCard:fee.ltmRebate",{rebate:.38608}):null]}):null]})}),e.jsx(be,{disabled:!0,className:"mt-7 mb-1",variant:"outline",type:"submit",children:h("LimitOrderCard:submit")})]})}),w?e.jsx(Is,{operationName:"limit_order_create",username:l.username,usrChain:l.chain,userID:l.id,dismissCallback:_,headerText:h("buy"===d?"LimitOrderCard:headerText.buying":"LimitOrderCard:headerText.selling",{amount:b,thisAssetA:a,total:v,thisAssetB:r}),trxJSON:"buy"===d?[{seller:l.id,amount_to_sell:{amount:Ue(v,n.precision).toFixed(0),asset_id:c.find((e=>e.s===r)).id},min_to_receive:{amount:Ue(b,t.precision).toFixed(0),asset_id:c.find((e=>e.s===a)).id},expiration:C,fill_or_kill:"fkill"===O,extensions:F?{on_fill:[[0,{fee_asset_id:"1.3.0",spread_percent:H?100*H:0,size_percent:V?100*V:0,expiration_seconds:1e9,repeat:U}]]}:{}}]:[{seller:l.id,amount_to_sell:{amount:Ue(b,t.precision).toFixed(0),asset_id:c.find((e=>e.s===a)).id},min_to_receive:{amount:Ue(v,n.precision).toFixed(0),asset_id:c.find((e=>e.s===r)).id},expiration:C,fill_or_kill:"fkill"===O,extensions:F?{on_fill:[[0,{fee_asset_id:"1.3.0",spread_percent:H,size_percent:V,expiration_seconds:1e9,repeat:U}]]}:{}}]},"buy"===d?`Buying${b}${a}for${v}${r}`:`Selling${b}${a}for${v}${r}`):null]})]})}function Ns(s){const{cardType:l,activeLimitCard:a,assetA:r,assetAData:t,assetB:n,assetBData:d,buyOrders:c,previousBuyOrders:o,sellOrders:m,previousSellOrders:x,marketOrdersLoading:h,orderBookItr:u,setOrderBookItr:p,_resetOrders:j,invertedMarket:b}=s,{t:y,i18n:g}=ge(ye.get(),{i18n:fe});let N,v,f,k;return!h||c||m||o||o.length||x||x.length?(N=y("buy"===l?"MarketOrderCard:openBuyLimitOrdersTitle":"MarketOrderCard:openSellLimitOrdersTitle"),v=y("buy"===l?"MarketOrderCard:buyLimitOrdersDescription":"MarketOrderCard:sellLimitOrdersDescription",{assetA:r,assetB:n}),f=({index:s,style:a})=>{let h;"buy"===l&&c?h=c:"buy"===l&&o?h=o:"sell"===l&&m?h=m:"sell"===l&&x&&(h=x);const u=h[s],p=parseFloat(u.price).toFixed(d.precision),j=parseFloat(u.base),b=parseFloat(u.quote),g=h.slice(0,s+1).map((e=>parseFloat(e.base))).reduce(((e,s)=>e+s),0).toFixed(d.precision),N=h.slice(0,s+1).map((e=>parseFloat(e.quote))).reduce(((e,s)=>e+s),0).toFixed(t.precision),v=i.useMemo((()=>"buy"===l?`/dex/index.html?market=${r}_${n}&type=sell&price=${p}&amount=${N}`:`/dex/index.html?market=${r}_${n}&type=buy&price=${p}&amount=${N}`),[r,n,p,g,N]);return e.jsx("div",{style:a,children:e.jsxs(Ss,{children:[e.jsx(Cs,{asChild:!0,children:e.jsx("div",{className:"col-span-4",children:e.jsxs("div",{className:"grid grid-cols-4 text-sm",children:[e.jsx("div",{className:"col-span-1 border-l-2 border-r-2 pl-3",children:p}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:"buy"===l?j:b}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:"buy"===l?b:j}),e.jsx("div",{className:"col-span-1 pl-3",children:g}),e.jsx("div",{className:"col-span-4",children:e.jsx(Je,{})})]})},`moc_${l}_${s}`)}),e.jsxs(Ts,{className:"sm:max-w-[800px] bg-white",children:[e.jsxs(Ms,{children:[e.jsx(Ls,{children:y("MarketOrderCard:proceedLimitOrderDataTitle")}),e.jsx(_s,{children:y("MarketOrderCard:proceedLimitOrderDataDescription",{cardType:"buy"===l?"sell":"buy"})})]}),e.jsx("span",{className:"pt-3",children:"buy"===l?y("MarketOrderCard:sellingQuoteForBase",{totalQuote:N,assetA:r,totalBase:g,assetB:n}):y("MarketOrderCard:sellingBaseForQuote",{totalBase:g,assetB:n,totalQuote:N,assetA:r})}),e.jsx("span",{children:y("MarketOrderCard:pricePerAsset",{price:p,assetB:n,assetA:r})}),e.jsx("a",{href:v,children:e.jsx(be,{className:"mt-2 h-6",children:y("MarketOrderCard:proceedButton")})})]})]},`${l}Dialog${s}`)})},k="buy"===l?c?c.length:o.length:m?m.length:x.length):(N=y("MarketOrderCard:loadingMarketOrdersTitle"),v=y("MarketOrderCard:loadingMarketOrdersDescription"),f=({index:s,style:a})=>{const r="buy"===l?o:x,i=r&&r.length?r[s]:null,n=i?parseFloat(i.price).toFixed(t.precision):null,d=i?parseFloat(i.base):null,c=i?parseFloat(i.quote):null,m=r&&r.length?r.slice(0,s+1).map((e=>parseFloat(e.base))).reduce(((e,s)=>e+s),0).toFixed(t.precision):null;return e.jsx("div",{style:a,children:e.jsxs(Ie,{children:[e.jsx(qe,{asChild:!0,children:e.jsx("div",{className:"col-span-4",children:e.jsxs("div",{className:"grid grid-cols-4 text-sm",children:[i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-span-1 border-l-2 border-r-2 pl-3",children:n}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:d}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:c}),e.jsx("div",{className:"col-span-1 pl-3",children:m})]}):e.jsx("div",{className:"col-span-4",children:e.jsx(D,{className:"h-4 w-full"})}),e.jsx("div",{className:"col-span-4",children:e.jsx(Je,{})})]})},`moc_loading_${l}_${s}`)}),e.jsxs(Re,{className:"w-80 text-sm pt-3",children:[y("MarketOrderCard:marketDataRefreshing"),e.jsx("br",{}),e.jsx(D,{className:"h-4 w-full"})]})]},`loadingOrderHoverCard${s}`)})},k=10),e.jsxs(J,{children:[e.jsxs(W,{children:[e.jsx(K,{children:N}),e.jsx(Y,{children:v})]}),e.jsxs(ae,{children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx("div",{className:"col-span-1 pl-3",children:"Price"}),e.jsxs("div",{className:"col-span-1 pl-3 text-md",children:["sell"===l&&r&&r.length<12?r:null,"sell"===l&&r&&r.length>=12&&t?t.id:null,"buy"===l&&n&&n.length<12?n:null,"buy"===l&&n&&n.length>=12&&d?d.id:null]}),e.jsxs("div",{className:"col-span-1 pl-3",children:["sell"===l&&n&&n.length<12?n:null,"sell"===l&&n&&n.length>=12&&d?d.id:null,"buy"===l&&r&&r.length<12?r:null,"buy"===l&&r&&r.length>=12&&t?t.id:null]}),e.jsxs("div",{className:"col-span-1 pl-3",children:[n&&n.length<7?`Total (${n})`:null,n&&n.length>=7&&d?`Total (${d.id})`:null]})]}),e.jsx(qs,{height:300,itemCount:k,itemSize:20,children:f})]})]})}function Js(s){const{type:l,publicMarketHistory:a,assetAData:r,assetBData:t}=s;ge(ye.get(),{i18n:fe});const n=i.useMemo((()=>a.filter((e=>e.type===l))),[a,l]),d=i.useMemo((()=>n.map(((s,a)=>{const i=s.price.split("."),n=r&&t&&i.length>1?He(s.price,"buy"===l?r.precision:t.precision):s.price;return e.jsx("div",{className:"col-span-4",children:e.jsxs("div",{className:"grid grid-cols-4 text-sm",children:[e.jsx("div",{className:"col-span-1 border-r-2 border-b-2 pl-3",children:n}),e.jsx("div",{className:"col-span-1 border-r-2 border-b-2 pl-3",children:s.amount}),e.jsx("div",{className:"col-span-1 border-r-2 border-b-2 pl-3",children:ws(s.date)}),e.jsx("div",{className:"col-span-1 border-r-2 border-b-2 pl-3",children:s.value})]})},`ms_${a}_${l}`)}))),[n,r,t,l]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-4 pl-3 text-md",children:[e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"grid grid-cols-1",children:[e.jsx("div",{className:"col-span-1",children:"Price"}),e.jsxs("div",{className:"col-span-1 text-sm",children:[r?r.symbol:"?","/",t?t.symbol:"?"]})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"grid grid-cols-1",children:[e.jsx("div",{className:"col-span-1",children:"Amount"}),e.jsx("div",{className:"col-span-1 text-sm",children:r?r.symbol:"?"})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"grid grid-cols-1",children:[e.jsx("div",{className:"col-span-1",children:"Date"}),e.jsx("div",{className:"col-span-1 text-sm",children:"Time since trade"})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"grid grid-cols-1",children:[e.jsx("div",{className:"col-span-1",children:"Total value"}),e.jsx("div",{className:"col-span-1 text-sm",children:t?t.symbol:"?"})]})})]}),e.jsx(We,{className:"h-72 w-full rounded-md border",children:e.jsx("div",{className:"grid grid-cols-4",children:d.length?d:null})})]})}function vs(s){const{type:l,publicMarketHistory:a,marketHistoryInProgress:r,reset:i,assetAData:t,assetBData:n}=s,{t:d,i18n:c}=ge(ye.get(),{i18n:fe});return e.jsxs(J,{children:[e.jsxs(W,{children:[e.jsx(K,{children:d("buy"===l?"MarketTradeContents:recentlyCompletedBuyOrdersTitle":"MarketTradeContents:recentlyCompletedSellOrdersTitle")}),e.jsx(Y,{children:d("buy"===l?"MarketTradeContents:recentlyCompletedBuyOrdersDescription":"MarketTradeContents:recentlyCompletedSellOrdersDescription")})]}),e.jsxs(ae,{className:"space-y-2",children:[r?e.jsx(D,{count:5}):null,a&&a.length?e.jsx(Js,{type:l,publicMarketHistory:a,assetAData:t,assetBData:n}):d("MarketTradeContents:noMarketHistoryFound")]})]})}function Ws(s){const{type:l,assetAData:a,assetBData:r,usrLimitOrders:t}=s,{t:n,i18n:d}=ge(ye.get(),{i18n:fe}),c=i.useMemo((()=>t.filter((e=>"buy"===l?e.sell_price.base.asset_id===a.id:e.sell_price.base.asset_id===r.id)).map((e=>{const s=[a,r].find((s=>s.id===e.sell_price.base.asset_id)).precision,i=[a,r].find((s=>s.id===e.sell_price.quote.asset_id)).precision,t=Ds(e.sell_price.base.asset_id,e.sell_price.quote.asset_id);let n=ke(e.sell_price.base.amount,s),d=ke(e.sell_price.quote.amount,i),c=parseFloat(t?n/d:n*d),o=0,m=0;const x=ke(e.for_sale,s);return"buy"!==l||t?"buy"===l&&t?(o=(c*x).toFixed(s),m=x.toFixed(i)):"sell"!==l||t?"sell"===l&&t&&(o=(x/c).toFixed(i),m=x.toFixed(s)):(o=x.toFixed(i),m=(c*x).toFixed(s)):(m=(c*x).toFixed(i),o=x.toFixed(s)),{...e,price:c,paying:m,receiving:o,basePrecision:s,quotePrecision:i}})).sort(((e,s)=>e.price-s.price))),[t,l,a,r]),o=i.useMemo((()=>c.map(((s,a)=>{const r=ke(1,s.basePrecision),i=ke(1,s.quotePrecision);return e.jsxs(Ss,{children:[e.jsx(Cs,{asChild:!0,children:e.jsx("div",{className:"col-span-3",children:e.jsxs("div",{className:"grid grid-cols-4 border-b-2 text-sm",children:[e.jsxs("div",{className:"col-span-1 border-r-2 pl-3",children:["buy"===l&&s.price<i?e.jsxs(Ie,{children:[e.jsx(qe,{children:`< ${i}`}),e.jsx(Re,{className:"w-"+5*s.quotePrecision,children:s.price})]},`hover_less_than_min_${s.id.replace("1.7.","")}`):null,"sell"===l&&s.price<r?e.jsxs(Ie,{children:[e.jsx(qe,{children:`< ${r}`}),e.jsx(Re,{className:"w-"+5*s.basePrecision,children:s.price})]},`hover_less_than_min_${s.id.replace("1.7.","")}`):null,"buy"===l&&s.price>=i?s.price.toFixed(s.quotePrecision):null,"sell"===l&&s.price>=r?s.price.toFixed(s.basePrecision):null]}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:s.receiving}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:s.paying}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:s.expiration.replace("T"," ")})]})},`mos_${a}_${l}`)}),e.jsxs(Ts,{className:"sm:max-w-[600px] bg-white",children:[e.jsxs(Ms,{children:[e.jsx(Ls,{children:n("MyOrderSummary:editLimitOrderTitle")}),e.jsx(_s,{children:n("MyOrderSummary:editLimitOrderDescription")})]}),e.jsxs("div",{className:"grid grid-cols-1",children:[e.jsxs("div",{className:"col-span-1",children:[n("MyOrderSummary:selectedOpenOrderData"),e.jsx(We,{className:"h-72 rounded-md border text-sm",children:e.jsx("pre",{children:JSON.stringify(s,null,2)})})]}),e.jsxs("div",{className:"col-span-1 text-left mt-5",children:[e.jsx("a",{href:`/order/index.html?id=${s.id}`,children:e.jsx(be,{variant:"outline",className:"mt-2 mr-2",children:n("MyOrderSummary:proceedToUpdateButton")})}),e.jsx(Ee,{variant:"outline",classnamecontents:"",type:"button",text:n("MyOrderSummary:viewObjectOnBlocksights"),hyperlink:`https://blocksights.info/#/objects/${s.id}`})]})]})]})]},`${l}Dialog${a}`)}))),[c,a,r,l]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx("div",{className:"col-span-1 pl-3",children:n("MyOrderSummary:priceColumnTitle")}),e.jsx("div",{className:"col-span-1 pl-3 text-md",children:a.symbol}),e.jsx("div",{className:"col-span-1 pl-3 text-md",children:r.symbol}),e.jsx("div",{className:"col-span-1 pl-3",children:n("MyOrderSummary:expirationDateColumnTitle")})]}),e.jsx(We,{className:"h-72 w-full rounded-md border",children:e.jsx("div",{className:"grid grid-cols-3",children:o})})]})}function ks(s){const{type:l,assetAData:a,assetBData:r,usrLimitOrders:t,usrHistory:n,marketHistoryInProgress:d,reset:c}=s,{t:o,i18n:m}=ge(ye.get(),{i18n:fe}),x=i.useMemo((()=>t&&t.length?"buy"===l?t.filter((e=>e.sell_price.quote.asset_id===r.id)):t.filter((e=>e.sell_price.quote.asset_id===a.id)):t?[]:null),[t,l,a,r]);return e.jsxs(J,{children:[e.jsxs(W,{children:[e.jsx(K,{children:o("buy"===l?"MyOpenOrders:openBuyOrdersTitle":"MyOpenOrders:openSellOrdersTitle")}),e.jsx(Y,{children:o("buy"===l?"MyOpenOrders:openBuyOrdersDescription":"MyOpenOrders:openSellOrdersDescription",{assetA:a.symbol,assetB:r.symbol})})]}),e.jsx(ae,{className:"space-y-2",children:x&&!d?e.jsx(Ws,{type:l,assetAData:a,assetBData:r,usrLimitOrders:x}):null})]})}function Ks(s){const{type:l,usrHistory:a,assetAData:r,assetBData:t}=s,{t:n,i18n:d}=ge(ye.get(),{i18n:fe}),c=i.useMemo((()=>a?a.filter((e=>"buy"===l?e.op[1].pays.asset_id===t.id&&e.op[1].receives.asset_id===r.id:e.op[1].pays.asset_id===r.id&&e.op[1].receives.asset_id===t.id)).map((e=>{const s=ke(e.op[1].fill_price.base.amount,[r,t].find((s=>s.id===e.op[1].fill_price.base.asset_id))?.precision),l=ke(e.op[1].fill_price.quote.amount,[r,t].find((s=>s.id===e.op[1].receives.asset_id))?.precision);return{price:(l/s).toFixed(t.precision),baseAmount:s,quoteAmount:l,date:e.block_time,operation:e.op[1]}})):[]),[a,r,t,l]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx("div",{className:"col-span-1 pl-3",children:n("MyTradeSummary:priceColumnTitle")}),e.jsx("div",{className:"col-span-1 pl-3 text-md",children:"buy"===l?r.symbol:t.symbol}),e.jsx("div",{className:"col-span-1 pl-3 text-md",children:"buy"===l?t.symbol:r.symbol}),e.jsx("div",{className:"col-span-1 pl-3",children:n("MyTradeSummary:dateColumnTitle")})]}),e.jsx(We,{className:"h-72 w-full rounded-md border",children:e.jsx("div",{className:"grid grid-cols-4",children:c.map(((s,a)=>e.jsx("div",{className:"col-span-4",children:e.jsxs("div",{className:"grid grid-cols-4 text-sm",children:[e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:s.price}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:"buy"===l?s.baseAmount:s.quoteAmount}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:"buy"===l?s.quoteAmount:s.baseAmount}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:ws(s.date)})]})},`mts_${a}_${l}`)))})})]})}function Os(s){const{type:l,usrHistory:a,marketHistoryInProgress:r,reset:i,assetAData:t,assetBData:n}=s,{t:d,i18n:c}=ge(ye.get(),{i18n:fe});return e.jsxs(J,{children:[e.jsxs(W,{children:[e.jsx(K,{children:d("buy"===l?"MyCompletedTrades:recentlyCompletedBuyOrdersTitle":"MyCompletedTrades:recentlyCompletedSellOrdersTitle")}),e.jsx(Y,{children:d("buy"===l?"MyCompletedTrades:recentlyCompletedBuyOrdersDescription":"MyCompletedTrades:recentlyCompletedSellOrdersDescription")})]}),e.jsxs(ae,{className:"space-y-2",children:[a&&a.length||r?null:"buy"===l?e.jsx(e.Fragment,{children:d("MyCompletedTrades:noRecentlyCompletedPurchases")}):e.jsx(e.Fragment,{children:d("MyCompletedTrades:noRecentlyCompletedSales")}),a&&a.length?e.jsx(Ks,{type:l,usrHistory:a,assetAData:t,assetBData:n}):null]})]})}function Xs(s){const{activeLimitCard:l,assetAData:a,assetBData:r,usr:t,marketItr:n,setMarketItr:d,usrLimitOrders:c,usrHistory:o,publicMarketHistory:m,_resetMarketData:x}=s,{t:h,i18n:u}=ge(ye.get(),{i18n:fe}),[p,j]=i.useState(!1);i.useEffect((()=>{m&&j(!1)}),[m]);const[b,y]=i.useState("marketTrades"),[g,N]=i.useState("buy"),[v,f]=i.useState("buy"),[k,O]=i.useState("buy"),C={backgroundColor:"#252526",color:"white"};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"grid grid-cols-1 mt-5",children:e.jsxs(Se,{defaultValue:"marketTrades",className:"w-full",children:[e.jsxs(Ce,{className:"grid w-full grid-cols-3 gap-2",children:["marketTrades"===b?e.jsx(S,{value:"marketTrades",style:C,children:h("MarketSummaryTabs:marketTradesTabTitle")}):e.jsx(S,{value:"marketTrades",onClick:()=>y("marketTrades"),children:h("MarketSummaryTabs:marketTradesTabTitle")}),"usrLimitOrders"===b?e.jsx(S,{value:"usrLimitOrders",style:C,children:h("MarketSummaryTabs:yourOpenOrdersTabTitle")}):e.jsx(S,{value:"usrLimitOrders",onClick:()=>y("usrLimitOrders"),children:h("MarketSummaryTabs:yourOpenOrdersTabTitle")})]}),e.jsx(le,{value:"marketTrades",children:e.jsxs(Se,{defaultValue:"buy",className:"w-full",children:[e.jsxs(Ce,{className:"grid w-full grid-cols-2 gap-2",children:["buy"===g?e.jsx(S,{value:"buy",style:C,children:h("MarketSummaryTabs:buyOrdersTabTitle")}):e.jsx(S,{value:"buy",onClick:()=>N("buy"),children:h("MarketSummaryTabs:buyOrdersTabTitle")}),"sell"===g?e.jsx(S,{value:"sell",style:C,children:h("MarketSummaryTabs:sellOrdersTabTitle")}):e.jsx(S,{value:"sell",onClick:()=>N("sell"),children:h("MarketSummaryTabs:sellOrdersTabTitle")})]}),e.jsx(le,{value:"buy",children:e.jsx(vs,{type:"buy",publicMarketHistory:m,marketHistoryInProgress:p,reset:()=>{x(),j(!0),d(n+1)},assetAData:a,assetBData:r})}),e.jsx(le,{value:"sell",children:e.jsx(vs,{type:"sell",publicMarketHistory:m,marketHistoryInProgress:p,reset:()=>{x(),j(!0),d(n+1)},assetAData:a,assetBData:r})})]})}),e.jsx(le,{value:"usrHistory",children:e.jsxs(Se,{defaultValue:"buy",className:"w-full",children:[e.jsxs(Ce,{className:"grid w-full grid-cols-2 gap-2",children:["buy"===v?e.jsx(S,{value:"buy",style:C,children:h("MarketSummaryTabs:buyOrdersTabTitle")}):e.jsx(S,{value:"buy",onClick:()=>f("buy"),children:h("MarketSummaryTabs:buyOrdersTabTitle")}),"sell"===v?e.jsx(S,{value:"sell",style:C,children:h("MarketSummaryTabs:sellOrdersTabTitle")}):e.jsx(S,{value:"sell",onClick:()=>f("sell"),children:h("MarketSummaryTabs:sellOrdersTabTitle")})]}),e.jsx(le,{value:"buy",children:e.jsx(Os,{type:"buy",assetAData:a,assetBData:r,usrHistory:o,marketHistoryInProgress:p,reset:()=>{x(),j(!0),d(n+1)}})}),e.jsx(le,{value:"sell",children:e.jsx(Os,{type:"sell",assetAData:a,assetBData:r,usrHistory:o,marketHistoryInProgress:p,reset:()=>{x(),j(!0),d(n+1)}})})]})}),e.jsx(le,{value:"usrLimitOrders",children:e.jsxs(Se,{defaultValue:"buy",className:"w-full",children:[e.jsxs(Ce,{className:"grid w-full grid-cols-2 gap-2",children:["buy"===k?e.jsx(S,{value:"buy",style:C,children:h("MarketSummaryTabs:yourBuyOrdersTabTitle")}):e.jsx(S,{value:"buy",onClick:()=>O("buy"),children:h("MarketSummaryTabs:yourBuyOrdersTabTitle")}),"sell"===k?e.jsx(S,{value:"sell",style:C,children:h("MarketSummaryTabs:yourSellOrdersTabTitle")}):e.jsx(S,{value:"sell",onClick:()=>O("sell"),children:h("MarketSummaryTabs:yourSellOrdersTabTitle")})]}),e.jsx(le,{value:"buy",children:e.jsx(ks,{type:"buy",assetAData:a,assetBData:r,usrLimitOrders:c,usrHistory:o,marketHistoryInProgress:p,reset:()=>{x(),j(!0),d(n+1)}})}),e.jsx(le,{value:"sell",children:e.jsx(ks,{type:"sell",assetAData:a,assetBData:r,usrLimitOrders:c,usrHistory:o,marketHistoryInProgress:p,reset:()=>{x(),j(!0),d(n+1)}})})]})})]})})})}function Ys(s){const{usr:l,assetA:a,assetB:r,assetAData:t,assetADetails:n,assetABitassetData:d,assetBData:c,assetBDetails:o,assetBBitassetData:m,limitOrderFee:x,setAssetA:h,setAssetB:u}=s,{t:p,i18n:j}=ge(ye.get(),{i18n:fe}),b=i.useSyncExternalStore(ze.subscribe,ze.get,(()=>!0)),y=i.useSyncExternalStore(Qe.subscribe,Qe.get,(()=>!0)),g=i.useMemo((()=>l&&l.chain&&(b||y)?"bitshares"===l.chain?b:y:[]),[b,y,l]),[N,v]=i.useState(null),[f,k]=i.useState(null),[O,C]=i.useState([]),[M,T]=i.useState([]),[L,w]=i.useState(null),[_,A]=i.useState(null),[B,P]=i.useState(null),[F,$]=i.useState(null),[H,Q]=i.useState(null),[q,V]=i.useState(0),[I,z]=i.useState(0),[R,U]=i.useState("buy"),[G,Z]=i.useState("buy"),X=i.useMemo((()=>Ds(t.id,c.id)),[t,c]);function ee(){v(null),k(null)}i.useEffect((()=>{(async function(){const e=new URLSearchParams(window.location.search),s=Object.fromEntries(e.entries()).type;let l=R;return("buy"===s||"sell"===s)&&(l=s),{finalType:l}})().then((({finalType:e})=>{e!==R&&U(e)}))}),[]);const se=i.useMemo((()=>zs([l.chain,a,r,l.id])),[l,a,r,I]),{data:re,loading:ie,error:te}=ts(se);i.useEffect((()=>{!re||ie||te?(v(null),k(null)):(v(re.bids),k(re.asks),C(re.bids),T(re.asks))}),[re,ie,te]);const ne=i.useMemo((()=>Qs([l.chain,t.id,c.id,l.id])),[l,t,c,q]),{data:de,loading:ce,error:oe}=ts(ne);i.useEffect((()=>{!de||ce||oe?(w(null),A(null),P(null),$(null),Q(null)):(w(de.balances),A(de.accountLimitOrders),P(de.marketHistory),$(de.usrTrades),Q(de.ticker))}),[de,ce,oe]);const me={backgroundColor:"#252526",color:"white"},[xe,he]=i.useState(!1),ue=e.jsxs(Ie,{children:[e.jsx(qe,{asChild:!0,style:{position:"relative"},children:e.jsxs(J,{className:"mt-5",children:[e.jsxs(W,{className:"pt-4 pb-2",children:[e.jsx(K,{children:p("Market:marketSummary")}),e.jsxs(Y,{className:"text-lg",children:["buy"===R?`${a}/${r}`:null,"sell"===R?`${r}/${a}`:null]})]}),e.jsx(ae,{className:"text-sm pb-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:latestPrice")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2 mb-1",children:H&&t?He(H.latest,t.precision):"?"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:24HrChange")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2 mb-1",children:H?H.percent_change:"?"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:24HrBaseVolume")}),e.jsx("div",{className:"col-span-3",children:e.jsxs(E,{variant:"outline",className:"ml-2 mb-1",children:[H?null:"?","buy"===R&&H?H.base_volume:null,"sell"===R&&H?H.quote_volume:null]})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:24HrQuoteVolume")}),e.jsx("div",{className:"col-span-3",children:e.jsxs(E,{variant:"outline",className:"ml-2 mb-1",children:[H?null:"?","buy"===R&&H?H.quote_volume:null,"sell"===R&&H?H.base_volume:null]})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:lowestAsk")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2 mb-1",children:H&&t?He(H.lowest_ask,t.precision):"?"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:highestBid")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2",children:H&&t?He(H.highest_bid,t.precision):"?"})})]})]})})]})}),e.jsxs(Re,{className:"w-80 text-sm text-center",children:[e.jsxs("b",{children:[a,"/",r," ",p("Market:externalMarketLinks")]}),e.jsx("br",{}),e.jsx(Ee,{variant:"outline",classnamecontents:"mb-2 mt-2",type:"button",text:p("Market:blocksightsMarketExplorer"),hyperlink:"bitshares"===l.chain?`https://blocksights.info/#/markets/${"buy"===R?a:r}/${"buy"===R?r:a}`:`https://blocksights.info/#/markets/${"buy"===R?a:r}/${"buy"===R?r:a}?network=testnet`}),"bitshares"===l.chain?e.jsxs(e.Fragment,{children:[e.jsx(Ee,{variant:"outline",classnamecontents:"ml-2",type:"button",text:"🔗 BTS.Exchange",hyperlink:"buy"===R?`https://bts.exchange/#/market/${a}_${r}?r=nftprofessional1`:`https://bts.exchange/#/market/${r}_${a}?r=nftprofessional1`}),e.jsx(Ee,{variant:"outline",classnamecontents:"ml-2",type:"button",text:"🔗 BTWTY",hyperlink:"buy"===R?`https://wallet.btwty.com/market/${a}_${r}?r=nftprofessional1`:`https://wallet.btwty.com/market/${r}_${a}?r=nftprofessional1`}),e.jsx(Ee,{variant:"outline",classnamecontents:"ml-2 mt-2",type:"button",text:"🔗 XBTS",hyperlink:"buy"===R?`https://ex.xbts.io/market/${a}_${r}?r=nftprofessional1`:`https://ex.xbts.io/market/${r}_${a}?r=nftprofessional1`})]}):null]})]});return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"container mx-auto mt-5 mb-5",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[e.jsxs("div",{className:"col-span-1",children:[e.jsxs(Se,{defaultValue:R,value:R,className:"w-full",children:[e.jsxs(Ce,{className:"grid w-full grid-cols-2 gap-2",children:[t&&c?null:e.jsxs(e.Fragment,{children:[e.jsx(S,{disabled:!0,value:"buy",style:me,children:p("Market:buy")}),e.jsx(S,{disabled:!0,value:"sell",children:p("Market:sell")})]}),t&&c&&"buy"===R?e.jsxs(e.Fragment,{children:[e.jsx(S,{value:"buy",style:me,children:p("Market:buy")}),e.jsx(S,{value:"sell",onClick:()=>{U("sell"),window.history.replaceState({},"",`${window.location.pathname}?${new URLSearchParams({...new URLSearchParams(window.location.search),price:0}).toString()}`)},children:p("Market:sell")})]}):null,t&&c&&"sell"===R?e.jsxs(e.Fragment,{children:[e.jsx(S,{value:"buy",onClick:()=>{U("buy"),window.history.replaceState({},"",`${window.location.pathname}?${new URLSearchParams({...new URLSearchParams(window.location.search),price:0,amount:0}).toString()}`)},children:p("Market:buy")}),e.jsx(S,{value:"sell",style:me,children:p("Market:sell")})]}):null]}),e.jsx(le,{value:"buy",children:e.jsx(fs,{usr:l,thisAssetA:a,thisAssetB:r,assetAData:t,assetBData:c,buyOrders:N,sellOrders:f,usrBalances:L,orderType:"buy",marketSearch:g,fee:x,invertedMarket:X},"buyLimit")}),e.jsx(le,{value:"sell",children:e.jsx(fs,{usr:l,thisAssetA:a,thisAssetB:r,assetAData:t,assetBData:c,buyOrders:N,sellOrders:f,usrBalances:L,orderType:"sell",marketSearch:g,fee:x,invertedMarket:X},"sellLimit")})]}),H&&t&&c?null:e.jsxs(J,{className:"mt-5",children:[e.jsxs(W,{className:"pt-4 pb-2",children:[e.jsx(K,{children:p("Market:marketSummary")}),e.jsx(Y,{className:"text-lg",children:"❔/❔"})]}),e.jsx(ae,{className:"text-sm pb-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:latestPrice")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2 mb-1",children:"❔"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:24HrChange")}),e.jsx("div",{className:"col-span-3",children:"❔"})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:24HrBaseVolume")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2 mb-1",children:"❔"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:24HrQuoteVolume")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2 mb-1",children:"❔"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:lowestAsk")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2 mb-1",children:"❔"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:highestBid")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2",children:"❔"})})]})]})})]}),H&&t&&c?ue:null]}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"grid grid-cols-1 gap-y-2",children:[e.jsx("div",{className:"flex-grow",children:e.jsxs(J,{children:[e.jsx(W,{className:"pt-2 pb-2",children:e.jsxs(K,{className:"text-center text-lg",children:["bitshares"===l.chain?"Bitshares ":"Bitshares (Testnet) ",p("Market:controls")]})}),e.jsx(ae,{className:"pb-3",children:e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsx(js,{assetSymbol:a,assetData:t,storeCallback:h,otherAsset:r,marketSearch:g,type:"buy"===R?"quote":"base",size:"small"}),e.jsx("a",{style:{lineHeight:1},href:`/dex/index.html?market=${r}_${a}`,onClick:()=>he(!0),children:e.jsx(be,{variant:"outline",className:"w-full h-7",children:xe?e.jsx(Ge,{className:"animate-spin"}):e.jsx(Ge,{})})}),e.jsx(js,{assetSymbol:r,assetData:c,storeCallback:u,otherAsset:a,marketSearch:g,type:"sell"===R?"quote":"base",size:"small"})]})})]})}),e.jsx("div",{className:"flex-grow",style:{paddingBottom:"0px"},children:n?e.jsx(ms,{asset:a,assetData:t,assetDetails:n,bitassetData:d,marketSearch:g,chain:l.chain,usrBalances:L,type:"buy"===R?"buy":"sell"}):e.jsxs(J,{children:[e.jsxs(W,{className:"pb-2 pt-4",children:[e.jsx(K,{children:p("buy"===R?"Market:quoteAsset":"Market:baseAsset")}),e.jsx(Y,{className:"text-lg",children:p("Market:loading")})]}),e.jsx(ae,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{className:"h-4 w-[250px]"}),e.jsx(D,{className:"h-4 w-[200px]"}),e.jsx(D,{className:"h-4 w-[250px]"}),e.jsx(D,{className:"h-4 w-[200px]"})]})})]})}),e.jsx("div",{className:"flex-grow",children:o?e.jsx(ms,{asset:r,assetData:c,assetDetails:o,bitassetData:m,marketSearch:g,chain:l.chain,usrBalances:L,type:"sell"===R?"buy":"sell"}):e.jsxs(J,{children:[e.jsxs(W,{className:"pb-2 pt-4",children:[e.jsx(K,{children:p("sell"===R?"Market:baseAsset":"Market:quoteAsset")}),e.jsx(Y,{className:"text-lg",children:p("Market:loading")})]}),e.jsx(ae,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{className:"h-4 w-[250px]"}),e.jsx(D,{className:"h-4 w-[200px]"}),e.jsx(D,{className:"h-4 w-[250px]"}),e.jsx(D,{className:"h-4 w-[200px]"})]})})]})})]})})]}),a&&r&&t&&c?e.jsx(Rs,{assetA:a,assetAData:t,assetB:r,assetBData:c,chain:l.chain}):null,e.jsx("div",{className:"grid grid-cols-1 gap-5 mt-5",children:t&&c?e.jsx(e.Fragment,{children:e.jsxs(Se,{defaultValue:"buy",className:"w-full",children:[e.jsxs(Ce,{className:"grid w-full grid-cols-2 gap-1",children:["buy"===G?e.jsx(S,{value:"buy",style:me,children:p("Market:buyOrders")}):e.jsx(S,{value:"buy",onClick:()=>Z("buy"),children:p("Market:buyOrders")}),"sell"===G?e.jsx(S,{value:"sell",style:me,children:p("Market:sellOrders")}):e.jsx(S,{value:"sell",onClick:()=>Z("sell"),children:p("Market:sellOrders")})]}),e.jsx(le,{value:"buy",children:e.jsx(Ns,{cardType:"buy",activeLimitCard:R,assetA:a,assetAData:t,assetB:r,assetBData:c,buyOrders:N,previousBuyOrders:O,sellOrders:f,previousSellOrders:M,marketOrdersLoading:ie,orderBookItr:I,setOrderBookItr:z,_resetOrders:ee,invertedMarket:X})}),e.jsx(le,{value:"sell",children:e.jsx(Ns,{cardType:"sell",activeLimitCard:R,assetA:a,assetAData:t,assetB:r,assetBData:c,buyOrders:N,previousBuyOrders:O,sellOrders:f,previousSellOrders:M,marketOrdersLoading:ie,orderBookItr:I,setOrderBookItr:z,_resetOrders:ee,invertedMarket:X})})]})}):null}),a&&r?e.jsx(Xs,{activeLimitCard:R,assetAData:t,assetBData:c,usr:l,marketItr:q,setMarketItr:V,usrLimitOrders:_,publicMarketHistory:B,usrHistory:F,_resetMarketData:function(){w(null),A(null),P(null),$(null),Q(null)}}):null]})})}function Gs(s){const{t:l,i18n:a}=ge(ye.get(),{i18n:fe}),r={backgroundColor:"#252526",color:"white"};return e.jsxs("div",{className:"container mx-auto mt-5 mb-5",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[e.jsxs("div",{className:"col-span-1",children:[e.jsxs(Se,{defaultValue:"buy",className:"w-full",children:[e.jsxs(Ce,{className:"grid w-full grid-cols-2 gap-2",children:[e.jsx(S,{disabled:!0,value:"buy",style:r,children:l("MarketPlaceholder:buyTab")}),e.jsx(S,{disabled:!0,value:"sell",children:l("MarketPlaceholder:sellTab")})]}),e.jsx(le,{value:"buy",children:e.jsxs(J,{children:[e.jsxs(W,{className:"pb-2",children:[e.jsx(K,{children:l("MarketPlaceholder:marketLimitOrderFormTitle")}),e.jsx(Y,{children:l("MarketPlaceholder:marketLimitOrderFormDescription")})]}),e.jsx(ae,{children:e.jsxs("div",{className:"grid grid-cols-1",children:[e.jsxs("div",{className:"grid grid-cols-2 mt-2",children:[e.jsx("div",{className:"text-sm mt-1",children:l("MarketPlaceholder:priceLabel")}),e.jsx("div",{className:"text-gray-500 text-right",children:e.jsx("span",{variant:"link",children:"?"})})]}),e.jsx("div",{className:"col-span-1",children:e.jsx(Q,{disabled:!0,className:"mb-2"})}),e.jsx("div",{className:"col-span-1 text-sm",children:l("MarketPlaceholder:pricePerAsset")}),e.jsxs("div",{className:"grid grid-cols-2 mt-2",children:[e.jsx("div",{className:"text-sm mt-1",children:l("MarketPlaceholder:amountLabel")}),e.jsx("div",{className:"text-gray-500 text-right",children:"?"})]}),e.jsx("div",{className:"col-span-1",children:e.jsx(Q,{disabled:!0,className:"mb-2"})}),e.jsx("div",{className:"col-span-1 text-sm",children:l("MarketPlaceholder:amountDescription")}),e.jsxs("div",{className:"grid grid-cols-2 mt-2",children:[e.jsx("div",{className:"text-sm mt-1",children:l("MarketPlaceholder:totalLabel")}),e.jsx("div",{className:"text-gray-500 text-right",children:"?"})]}),e.jsx("div",{className:"col-span-1",children:e.jsx(Q,{disabled:!0,className:"mb-2"})}),e.jsx("div",{className:"col-span-1 text-sm",children:l("MarketPlaceholder:totalDescription")}),e.jsx("div",{className:"text-sm col-span-1 mt-2",children:l("MarketPlaceholder:expirationLabel")}),e.jsx("div",{className:"col-span-1",children:e.jsx(Ze,{disabled:!0,children:e.jsx(es,{className:"mb-3",children:e.jsx(ss,{placeholder:l("MarketPlaceholder:expirationPlaceholder")})})})}),e.jsx("div",{className:"col-span-1 text-sm",children:l("MarketPlaceholder:expirationDescription")}),e.jsx("div",{className:"text-sm col-span-1",children:l("MarketPlaceholder:feeLabel")}),e.jsx("div",{className:"col-span-1",children:e.jsx(Q,{disabled:!0,label:l("MarketPlaceholder:feeInputLabel")})}),e.jsx("div",{className:"col-span-1 text-sm",children:l("MarketPlaceholder:feeDescription")}),e.jsx("div",{className:"col-span-1",children:e.jsx(be,{disabled:!0,className:"mt-4 mb-1",variant:"outline",type:"submit",children:l("MarketPlaceholder:submitButton")})})]})})]})})]}),e.jsxs(J,{className:"mt-5",children:[e.jsxs(W,{className:"pt-4 pb-2",children:[e.jsx(K,{children:l("MarketPlaceholder:marketSummaryTitle")}),e.jsx(Y,{className:"text-lg",children:"❔/❔"})]}),e.jsx(ae,{className:"text-sm pb-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:l("MarketPlaceholder:latestPriceLabel")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2 mb-1",children:"❔"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:l("MarketPlaceholder:24HrChangeLabel")}),e.jsx("div",{className:"col-span-3",children:"❔"})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:l("MarketPlaceholder:24HrBaseVolumeLabel")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2 mb-1",children:"❔"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:l("MarketPlaceholder:24HrQuoteVolumeLabel")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2 mb-1",children:"❔"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:l("MarketPlaceholder:lowestAskLabel")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2 mb-1",children:"❔"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:l("MarketPlaceholder:highestBidLabel")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2",children:"❔"})})]})]})})]})]}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"grid grid-cols-1 gap-y-2",children:[e.jsx("div",{className:"flex-grow",children:e.jsxs(J,{children:[e.jsx(W,{className:"pt-2 pb-2",children:e.jsx(K,{className:"text-center text-lg",children:l("MarketPlaceholder:dexMarketControlsTitle")})}),e.jsx(ae,{className:"pb-3",children:e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsx(be,{variant:"outline",className:"h-5 p-3",children:"❔"}),e.jsx(be,{variant:"outline",className:"w-full h-5 p-3",children:e.jsx(Ge,{})}),e.jsx(be,{variant:"outline",className:"h-5 p-3",children:"❔"})]})})]})}),e.jsx("div",{className:"flex-grow",style:{paddingBottom:"0px"},children:e.jsxs(J,{children:[e.jsxs(W,{className:"pb-2 pt-4",children:[e.jsx(K,{children:l("MarketPlaceholder:assetCardTitle",{asset:"?"})}),e.jsx(Y,{className:"text-lg",children:l("MarketPlaceholder:loadingAssetDescription")})]}),e.jsx(ae,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{className:"h-4 w-[250px]"}),e.jsx(D,{className:"h-4 w-[200px]"}),e.jsx(D,{className:"h-4 w-[250px]"}),e.jsx(D,{className:"h-4 w-[200px]"})]})})]})}),e.jsx("div",{className:"flex-grow",children:e.jsxs(J,{children:[e.jsxs(W,{className:"pb-2 pt-4",children:[e.jsx(K,{children:l("MarketPlaceholder:assetCardTitle",{asset:"?"})}),e.jsx(Y,{className:"text-lg",children:l("MarketPlaceholder:loadingAssetDescription")})]}),e.jsx(ae,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{className:"h-4 w-[250px]"}),e.jsx(D,{className:"h-4 w-[200px]"}),e.jsx(D,{className:"h-4 w-[250px]"}),e.jsx(D,{className:"h-4 w-[200px]"})]})})]})})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-5 mt-5",children:[e.jsx(J,{children:e.jsxs(W,{className:"pb-2",children:[e.jsx(K,{children:"?"}),e.jsx(Y,{children:l("MarketPlaceholder:loadingAssetDescription")})]})}),e.jsx(J,{children:e.jsxs(W,{className:"pb-2",children:[e.jsx(K,{children:"?"}),e.jsx(Y,{children:l("MarketPlaceholder:loadingAssetDescription")})]})}),e.jsx(J,{children:e.jsxs(W,{className:"pb-2",children:[e.jsx(K,{children:"?"}),e.jsx(Y,{children:l("MarketPlaceholder:loadingAssetDescription")})]})})]}),e.jsx("div",{className:"grid grid-cols-1 gap-5 mt-5",children:e.jsxs(Se,{defaultValue:"buy",className:"w-full",children:[e.jsxs(Ce,{className:"grid w-full grid-cols-2 gap-1",children:[e.jsx(S,{value:"buy",style:r,children:l("MarketPlaceholder:buyTabTitle")}),e.jsx(S,{value:"sell",children:l("MarketPlaceholder:sellTabTitle")})]}),e.jsx(le,{value:"buy",children:e.jsx(J,{children:e.jsxs(W,{children:[e.jsx(K,{children:l("MarketPlaceholder:loadingMarketOrdersTitle")}),e.jsx(Y,{children:l("MarketPlaceholder:loadingMarketOrdersDescription")}),e.jsxs(ae,{children:[e.jsx(D,{className:"h-4 w-full mt-1"}),e.jsx(D,{className:"h-4 w-full mt-1"}),e.jsx(D,{className:"h-4 w-full mt-1"}),e.jsx(D,{className:"h-4 w-full mt-1"}),e.jsx(D,{className:"h-4 w-full mt-1"})]}),e.jsx(Ps,{children:e.jsx(be,{className:"mt-5",children:l("MarketPlaceholder:retryRequestButton")})})]})})})]})}),e.jsx("div",{className:"grid grid-cols-1 mt-5",children:e.jsxs(Se,{defaultValue:"marketTrades",className:"w-full",children:[e.jsxs(Ce,{className:"grid w-full grid-cols-3 gap-2",children:[e.jsx(S,{value:"marketTrades",style:r,children:l("MarketPlaceholder:marketTradesTabTitle")}),e.jsx(S,{value:"usrHistory",children:l("MarketPlaceholder:yourTradesTabTitle")}),e.jsx(S,{value:"usrLimitOrders",children:l("MarketPlaceholder:yourOpenOrdersTabTitle")})]}),e.jsx(le,{value:"marketTrades",children:e.jsxs(Se,{defaultValue:"buy",className:"w-full",children:[e.jsxs(Ce,{className:"grid w-full grid-cols-2 gap-2",children:[e.jsx(S,{value:"buy",style:r,children:l("MarketPlaceholder:buyOrdersTabTitle")}),e.jsx(S,{value:"sell",children:l("MarketPlaceholder:sellOrdersTabTitle")})]}),e.jsx(le,{value:"buy",children:e.jsxs(J,{children:[e.jsxs(W,{children:[e.jsx(K,{children:l("MarketPlaceholder:completedOrdersTitle",{asset:"?"})}),e.jsx(Y,{children:l("MarketPlaceholder:recentlyCompletedOrdersDescription")})]}),e.jsxs(ae,{className:"space-y-2",children:[e.jsx(D,{className:"h-4 w-full mt-1"}),e.jsx(D,{className:"h-4 w-full mt-1"}),e.jsx(D,{className:"h-4 w-full mt-1"}),e.jsx(D,{className:"h-4 w-full mt-1"}),e.jsx(D,{className:"h-4 w-full mt-1"}),e.jsx(D,{className:"h-4 w-full mt-1"})]})]})})]})})]})})]})}function kr(s){ge(ye.get(),{i18n:fe});const l=i.useSyncExternalStore(is.subscribe,is.get,(()=>!0)),a=i.useSyncExternalStore(ns.subscribe,ns.get,(()=>!0)),r=i.useSyncExternalStore(cs.subscribe,cs.get,(()=>!0)),t=i.useSyncExternalStore(ds.subscribe,ds.get,(()=>!0)),n=i.useSyncExternalStore(os.subscribe,os.get,(()=>!0)),d=i.useSyncExternalStore(ze.subscribe,ze.get,(()=>!0)),c=i.useSyncExternalStore(Qe.subscribe,Qe.get,(()=>!0)),o=i.useMemo((()=>l&&l.chain?l.chain:"bitshares"),[l]);Fs(o??"bitshares",["assets","globalParams","marketSearch","pools"]);const m=i.useMemo((()=>o&&(a||r)?"bitshares"===o?a:r:[]),[a,r,o]),x=i.useMemo((()=>o&&(t||n)?"bitshares"===o?t:n:[]),[t,n,o]),h=i.useMemo((()=>o&&(d||c)?"bitshares"===o?d:c:[]),[d,c,o]),[u,p]=i.useState(0);i.useEffect((()=>{if(x&&x.parameters){const e=x.find((e=>1===e[0])),s=ke(e[1].fee,5);p(s)}}),[x]);const j=i.useMemo((()=>h.map((e=>e.s))),[h]),b=i.useMemo((()=>h.map((e=>e.id))),[h]),[y,g]=i.useState(window.location.search?null:"BTS"),[N,v]=i.useState(window.location.search?null:"USD");i.useEffect((()=>{h&&h.length&&window.location.search&&async function(){const e=new URLSearchParams(window.location.search),s=Object.fromEntries(e.entries()).market;let l=y,a=N;if(s&&s.length){let e=s.split("_")[0].toUpperCase(),r=s.split("_")[1].toUpperCase();if(e&&r&&r.length&&e===r&&(r="BTS"===e?"USD":"1.3.0",console.log("Invalid market parameters - replaced quote asset.")),(!e||!e.length||!j.includes(e)&&!b.includes(e))&&(console.log("Asset A replaced with default."),l="1.3.0"),!l){const s=h.find((s=>s.id===e||s.s===e));s?l=s.s:(console.log("Setting default asset A"),l="1.3.0")}if((!r||!r.length||!j.includes(r)&&!b.includes(r))&&(console.log("Asset B replaced with default."),a="USD"!==l?"USD":"1.3.0"),!a){const s=h.find((e=>e.id===r||e.s===r));s?a=s.s:(console.log("Setting default asset B"),a="BTS"!==e&&"1.3.0"!==e?"1.3.0":"USD")}}else console.log("No market parameters found."),l="1.3.0",a="USD";return{finalAssetA:l,finalAssetB:a}}().then((({finalAssetA:e,finalAssetB:s})=>{g(e),v(s)}))}),[h]);const[f,k]=i.useState(null),[O,S]=i.useState(null),[C,D]=i.useState(null),[M,T]=i.useState(null),[L,w]=i.useState(null),[_,A]=i.useState(null);return i.useEffect((()=>{let e;if(y&&l&&l.chain){if(k(null),D(null),w(null),m&&m.length){const e=m.find((e=>e.s===y));if(e)return void k(e)}e=bs([l.chain,y]).subscribe((({data:e})=>{e&&!e.error&&!e.loading&&k(e)}))}return()=>{e&&e()}}),[y,l]),i.useEffect((()=>{let e;if(N&&l&&l.chain){if(S(null),T(null),A(null),m&&m.length){const e=m.find((e=>e.s===N));if(e)return void S(e)}e=bs([l.chain,N]).subscribe((({data:e})=>{e&&!e.error&&!e.loading&&S(e)}))}return()=>{e&&e()}}),[N,l]),i.useEffect((()=>{let e,s;return f&&l&&l.chain&&(e=gs([l.chain,f.id]).subscribe((({data:e})=>{e&&!e.error&&!e.loading&&D(e)})),f.bitasset_data_id&&(s=ys([l.chain,f.bitasset_data_id]).subscribe((({data:e})=>{e&&!e.error&&!e.loading&&w(e)})))),()=>{e&&e(),s&&s()}}),[f,l]),i.useEffect((()=>{let e,s;return O&&l&&l.chain&&(e=gs([l.chain,O.id]).subscribe((({data:e})=>{e&&!e.error&&!e.loading&&T(e)})),O.bitasset_data_id&&(s=ys([l.chain,O.bitasset_data_id]).subscribe((({data:e})=>{e&&!e.error&&!e.loading&&A(e)})))),()=>{e&&e(),s&&s()}}),[O,l]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"container mx-auto mt-5 mb-5",children:l&&l.chain&&y&&N&&f&&O&&C&&M?e.jsx(e.Fragment,{children:e.jsx(Ys,{usr:l,assetA:y,assetB:N,assetAData:f,assetADetails:C,assetABitassetData:L,assetBData:O,assetBDetails:M,assetBBitassetData:_,limitOrderFee:u,setAssetA:e=>{g(e)},setAssetB:e=>{v(e)}},`Market_${y}_${N}`)}):e.jsx(Gs,{})}),l&&l.username&&l.username.length?e.jsx($s,{usr:l}):null," "]})}export{kr as default};