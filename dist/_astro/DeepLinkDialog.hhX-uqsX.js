import{j as e,c as k,u as v,l as $,d as J,s as B,a as E,i as F}from"./utils.f2cWa0M5.js";import{r as i}from"./index.sXsv9c-e.js";import{T as _,a as R,b as h,c as m,f as M}from"./common.hInvFuHt.js";import{a as q,_ as A}from"./index.LDFW_GCY.js";import{c as P,B as c}from"./button.a7-WOX-8.js";import{D as U,a as V,b as X,c as H,d as I}from"./dialog.syK3Ff39.js";const z=i.forwardRef((n,t)=>i.createElement(q.label,A({},n,{ref:t,onMouseDown:s=>{var o;(o=n.onMouseDown)===null||o===void 0||o.call(n,s),!s.defaultPrevented&&s.detail>1&&s.preventDefault()}}))),L=z,G=P("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=i.forwardRef(({className:n,...t},s)=>e.jsx(L,{ref:s,className:k(G(),n),...t}));d.displayName=L.displayName;const N=i.forwardRef(({className:n,...t},s)=>e.jsx("textarea",{className:k("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",n),ref:s,...t}));N.displayName="Textarea";function se(n){const{trxJSON:t,operationName:s,username:o,usrChain:r,userID:C,dismissCallback:T,headerText:w}=n,{t:a,i18n:K}=v($.get(),{i18n:F}),[p,x]=i.useState("object"),[l,y]=i.useState();i.useEffect(()=>{async function b(){const f=await fetch(`http://localhost:8080/api/deeplink/${r}/${s}`,{method:"POST",body:JSON.stringify(t)});if(!f.ok){console.log("Failed to fetch deeplink");return}const g=await f.json();if(g&&g.result){const O=J(B(g.result,!0)),j=JSON.parse(E(O));j.generatedDeepLink&&y(j.generatedDeepLink)}}r&&s&&t&&b()},[r,s,t]);const[D,u]=i.useState(!1),S=()=>{D||(u(!0),setTimeout(()=>{u(!1)},1e4))};return e.jsx(U,{open:!0,onOpenChange:b=>{T(b)},children:e.jsxs(V,{className:"sm:max-w-[800px] bg-white",children:[e.jsxs(X,{children:[e.jsx(H,{children:l?e.jsx(e.Fragment,{children:w}):a("DeepLinkDialog:dialogContent.generatingDeeplink")}),e.jsxs(I,{children:[a("DeepLinkDialog:dialogContent.withAccount",{username:o,userID:C}),l?e.jsxs(e.Fragment,{children:[e.jsx("br",{}),a("DeepLinkDialog:dialogContent.readyToBroadcast"),e.jsx("br",{}),a("DeepLinkDialog:dialogContent.chooseMethod")]}):null]})]}),p?e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"mt-3"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:e.jsxs(_,{defaultValue:"object",className:"w-full",children:[e.jsxs(R,{className:"grid w-full grid-cols-3 gap-2",children:[e.jsx(h,{value:"object",onClick:()=>x("object"),children:a("DeepLinkDialog:tabs.viewTRXObject")},"TRXTab"),e.jsx(h,{value:"deeplink",onClick:()=>x("deeplink"),children:a("DeepLinkDialog:tabs.rawDeeplink")},"DLTab"),e.jsx(h,{value:"localJSON",onClick:()=>x("localJSON"),children:a("DeepLinkDialog:tabs.localJSONFile")},"JSONTab")]},`${p||"loading"}_TabList`),e.jsxs(m,{value:"object",children:[e.jsxs("div",{className:"grid w-full gap-1.5 mb-3",children:[e.jsx(d,{className:"text-left",children:a("DeepLinkDialog:tabsContent.transactionObjectJSON")}),e.jsx("span",{className:"text-left text-sm",children:a("DeepLinkDialog:tabsContent.operationType",{operationName:s})}),e.jsx(N,{value:JSON.stringify(t,null,4),className:"min-h-[250px]",id:"trxJSON",readOnly:!0})]}),e.jsx(c,{onClick:()=>{M(JSON.stringify(t,null,4))},children:a("DeepLinkDialog:tabsContent.copyOperationJSON")})]}),e.jsxs(m,{value:"deeplink",children:[e.jsx(d,{className:"text-left",children:a("DeepLinkDialog:tabsContent.usingDeeplink")}),e.jsxs("ol",{className:"ml-4",children:[e.jsx("li",{type:"1",children:a("DeepLinkDialog:tabsContent.step1")}),e.jsx("li",{type:"1",children:a("DeepLinkDialog:tabsContent.step2",{operationName:s})}),e.jsx("li",{type:"1",children:a("DeepLinkDialog:tabsContent.step3")}),e.jsx("li",{type:"1",children:a("DeepLinkDialog:tabsContent.step4")}),e.jsx("li",{type:"1",children:a("DeepLinkDialog:tabsContent.step5")})]}),l?e.jsxs(e.Fragment,{children:[e.jsx("a",{href:`rawbeet://api?chain=${r==="bitshares"?"BTS":"BTS_TEST"}&request=${l}`,children:e.jsx(c,{className:"mt-4",children:"BEET"})}),e.jsx("a",{href:`rawbeeteos://api?chain=${r==="bitshares"?"BTS":"BTS_TEST"}&request=${l}`,children:e.jsx(c,{className:"mt-4 ml-3",children:"BeetEOS"})})]}):null]}),e.jsxs(m,{value:"localJSON",children:[e.jsx(d,{className:"text-left",children:a("DeepLinkDialog:tabsContent.viaLocalFile")}),e.jsxs("ol",{className:"ml-4",children:[e.jsx("li",{type:"1",children:a("DeepLinkDialog:tabsContent.step1Local")}),e.jsx("li",{type:"1",children:a("DeepLinkDialog:tabsContent.step2Local",{operationName:s})}),e.jsx("li",{type:"1",children:a("DeepLinkDialog:tabsContent.step3Local")}),e.jsx("li",{type:"1",children:a("DeepLinkDialog:tabsContent.step4Local")}),e.jsx("li",{type:"1",children:a("DeepLinkDialog:tabsContent.step5Local")})]}),l&&D?e.jsx(c,{className:"mt-4",variant:"outline",disabled:!0,children:a("DeepLinkDialog:tabsContent.downloading")}):null,l&&!D?e.jsx("a",{href:`data:text/json;charset=utf-8,${l}`,download:`${s}.json`,target:"_blank",rel:"noreferrer",onClick:S,children:e.jsx(c,{className:"mt-4",children:a("DeepLinkDialog:tabsContent.downloadBeetOperationJSON")})}):null]})]},l?"deeplinkLoaded":"loading")})]}):null]})})}export{se as D,d as L};
