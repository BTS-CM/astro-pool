import{I as R,J as O,u as e,K as u,P as J,Q as K,S as L,O as V,T as q,U as G,V as Q,W as X,X as Y,Y as Z}from"./button.XYtNsIwi.js";import{r as h,c as ee}from"./index.ebYJtNMn.js";import{$ as T,f as F,C as p,s as H,A as M,b as g,c as j,d as f,g as v,I as se,h as E,H as te,a as ne,e as re,r as ie}from"./input.2f7523pR.js";var ce=Object.defineProperty,oe=(t,s,n)=>s in t?ce(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,y=(t,s,n)=>(oe(t,typeof s!="symbol"?s+"":s,n),n),D=new Map,k=new WeakMap,P=0,le=void 0;function ae(t){return t?(k.has(t)||(P+=1,k.set(t,P.toString())),k.get(t)):"0"}function de(t){return Object.keys(t).sort().filter(s=>t[s]!==void 0).map(s=>`${s}_${s==="root"?ae(t.root):t[s]}`).toString()}function he(t){let s=de(t),n=D.get(s);if(!n){const l=new Map;let r;const c=new IntersectionObserver(a=>{a.forEach(o=>{var d;const C=o.isIntersecting&&r.some(m=>o.intersectionRatio>=m);t.trackVisibility&&typeof o.isVisible>"u"&&(o.isVisible=C),(d=l.get(o.target))==null||d.forEach(m=>{m(C,o)})})},t);r=c.thresholds||(Array.isArray(t.threshold)?t.threshold:[t.threshold||0]),n={id:s,observer:c,elements:l},D.set(s,n)}return n}function ue(t,s,n={},l=le){if(typeof window.IntersectionObserver>"u"&&l!==void 0){const d=t.getBoundingClientRect();return s(l,{isIntersecting:l,target:t,intersectionRatio:typeof n.threshold=="number"?n.threshold:0,time:0,boundingClientRect:d,intersectionRect:d,rootBounds:d}),()=>{}}const{id:r,observer:c,elements:a}=he(n);let o=a.get(t)||[];return a.has(t)||a.set(t,o),o.push(s),c.observe(t),function(){o.splice(o.indexOf(s),1),o.length===0&&(a.delete(t),c.unobserve(t)),a.size===0&&(c.disconnect(),D.delete(r))}}function xe(t){return typeof t.children!="function"}var pe=class extends h.Component{constructor(t){super(t),y(this,"node",null),y(this,"_unobserveCb",null),y(this,"handleNode",s=>{this.node&&(this.unobserve(),!s&&!this.props.triggerOnce&&!this.props.skip&&this.setState({inView:!!this.props.initialInView,entry:void 0})),this.node=s||null,this.observeNode()}),y(this,"handleChange",(s,n)=>{s&&this.props.triggerOnce&&this.unobserve(),xe(this.props)||this.setState({inView:s,entry:n}),this.props.onChange&&this.props.onChange(s,n)}),this.state={inView:!!t.initialInView,entry:void 0}}componentDidMount(){this.unobserve(),this.observeNode()}componentDidUpdate(t){(t.rootMargin!==this.props.rootMargin||t.root!==this.props.root||t.threshold!==this.props.threshold||t.skip!==this.props.skip||t.trackVisibility!==this.props.trackVisibility||t.delay!==this.props.delay)&&(this.unobserve(),this.observeNode())}componentWillUnmount(){this.unobserve()}observeNode(){if(!this.node||this.props.skip)return;const{threshold:t,root:s,rootMargin:n,trackVisibility:l,delay:r,fallbackInView:c}=this.props;this._unobserveCb=ue(this.node,this.handleChange,{threshold:t,root:s,rootMargin:n,trackVisibility:l,delay:r},c)}unobserve(){this._unobserveCb&&(this._unobserveCb(),this._unobserveCb=null)}render(){const{children:t}=this.props;if(typeof t=="function"){const{inView:B,entry:A}=this.state;return t({inView:B,entry:A,ref:this.handleNode})}const{as:s,triggerOnce:n,threshold:l,root:r,rootMargin:c,onChange:a,skip:o,trackVisibility:d,delay:C,initialInView:m,fallbackInView:S,...w}=this.props;return h.createElement(s||"div",{ref:this.handleNode,...w},t)}};function ge(t){const{t:s,i18n:n}=R(O.get(),{i18n:V}),l=h.useSyncExternalStore(T.subscribe,T.get,()=>!0),[r,c]=h.useState(),[a,o]=h.useState(),[d,C]=h.useState(),[m,S]=h.useState(),[w,B]=h.useState();h.useEffect(()=>F.subscribe(b=>{B(b.users)}),[F]);const[A,N]=h.useState(!1),[x,I]=h.useState();async function U(){const i=await fetch(`http://localhost:8080/api/accountLookup/${r}/${d}`,{method:"GET"});if(!i.ok){console.log({error:new Error(`${i.status} ${i.statusText}`),msg:s("AccountSelect:noAccount")}),N(!1);return}const b=await i.json();if(b&&b.result){const z=J(K(b.result,!0)),W=JSON.parse(L(z));N(!1),I(W);return}N(!1),S(s("AccountSelect:noAccount"))}const _=x?e.jsx(p,{className:"w-1/2",onClick:()=>{H(x.name,x.id,x.referrer,r)},children:e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx("div",{className:"col-span-1 pt-6 pl-4",children:e.jsx(M,{size:40,name:x.name,extra:"",expression:{eye:"normal",mouth:"open"},colors:["#92A1C6","#146A7C","#F0AB3D","#C271B4","#C20D90"]})}),e.jsx("div",{className:"col-span-3",children:e.jsxs(g,{children:[e.jsx(j,{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:x.name}),e.jsx(f,{children:x.id})]})})]})},x.id):null,$=({user:i})=>e.jsxs(te,{children:[e.jsx(ne,{asChild:!0,children:e.jsx(p,{onClick:()=>{H(i.username,i.id,i.referrer,i.chain)},children:e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx("div",{className:"col-span-1 pt-6 pl-2",children:e.jsx(M,{size:40,name:i.username,extra:"",expression:{eye:"normal",mouth:"open"},colors:["#92A1C6","#146A7C","#F0AB3D","#C271B4","#C20D90"]})}),e.jsx("div",{className:"col-span-3",children:e.jsxs(g,{children:[e.jsx(j,{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:i.username}),e.jsx(f,{children:i.id})]})})]})})}),e.jsxs(re,{className:"w-80",children:[s("AccountSelect:forgetPrompt",{user:i.username}),e.jsx("br",{}),e.jsx(u,{className:"w-full mt-2 text-bold text-white",variant:"destructive",onClick:()=>{ie(i.id)},children:s("AccountSelect:forgetButton")})]})]},i.id);return e.jsxs("div",{className:"grid grid-cols-1",children:[r?null:e.jsxs(p,{children:[e.jsxs(g,{children:[e.jsx(j,{children:s("AccountSelect:noChain.title")}),e.jsx(f,{children:s("AccountSelect:noChain.description")})]}),e.jsxs(v,{children:[e.jsx(u,{className:"mr-2",onClick:()=>c("bitshares"),children:"Bitshares (BTS)"}),e.jsxs(u,{onClick:()=>c("bitshares_testnet"),children:["Bitshares ",s("AccountSelect:noChain.testnet")," (TEST)"]})]})]}),r&&!a?e.jsxs(p,{children:[e.jsxs(g,{children:[e.jsx(j,{children:s(r==="bitshares"?"AccountSelect:noMode.titleBTS":"AccountSelect:noMode.titleTEST")}),e.jsx(f,{children:s("AccountSelect:noMode.description")})]}),e.jsxs(v,{children:[e.jsx(u,{className:"mr-2",onClick:()=>o("new"),children:s("AccountSelect:noMode.new")}),e.jsx(u,{onClick:()=>o("existing"),children:s("AccountSelect:noMode.existing")}),e.jsx("br",{}),e.jsx(u,{className:"mt-2",onClick:()=>c(null),children:s("AccountSelect:noMode.back")})]})]}):null,r&&a&&a==="new"&&!x?e.jsxs(p,{children:[e.jsxs(g,{children:[e.jsx(j,{children:r==="bitshares"?"🔐 Bitshares (BTS)":"🔐 Bitshares testnet (TEST)"}),e.jsx(f,{children:s("AccountSelect:new.initDesc")})]}),e.jsxs(v,{children:[e.jsx(se,{value:d||"",placeholder:"Account name or ID",onKeyDown:i=>{i.key==="Enter"&&!A&&(N(!0),U())},onChange:i=>{/^[a-zA-Z0-9.-]*$/.test(i.target.value)&&(C(i.target.value),S(),I())}}),m?e.jsx("p",{className:"text-red-500 text-xs italic",children:m||"ERROR"}):null]}),e.jsxs(E,{children:[e.jsx(u,{className:"mr-2",onClick:()=>o(null),children:s("AccountSelect:new.back")}),d&&!A?e.jsx(u,{onClick:()=>U(),children:s("AccountSelect:new.continue")}):e.jsx(u,{disabled:!0,children:s("AccountSelect:new.continue")})]})]}):null,x?e.jsxs(p,{children:[e.jsxs(g,{children:[e.jsxs(j,{children:[r==="bitshares"?"🔐 Bitshares (BTS) ":"🔐 Bitshares testnet (TEST) ",s("AccountSelect:new.title")]}),e.jsx(f,{children:s("AccountSelect:new.description")})]}),e.jsx(v,{children:l&&r!==l.chain?e.jsx("a",{href:window.location.pathname,children:_}):_}),e.jsx(E,{children:e.jsx(u,{variant:"outline",className:"mr-2",onClick:()=>{S(),I()},children:s("AccountSelect:new.back")})})]}):null,a&&a==="existing"?e.jsxs(p,{children:[e.jsxs(g,{children:[e.jsx(j,{children:r==="bitshares"?"Bitshares (BTS)":"Bitshares testnet (TEST)"}),e.jsx(f,{children:s("AccountSelect:existing.description")})]}),e.jsx(v,{children:e.jsx("div",{className:"grid grid-cols-3 gap-3",children:w.filter(i=>i.chain===r).length?w.filter(i=>i.chain===r).map(i=>l&&r!==l.chain?e.jsx("a",{href:window.location.pathname,children:e.jsx($,{user:i})}):e.jsx($,{user:i})):e.jsx("p",{className:"text-red-500 text-xs italic",children:s("AccountSelect:existing.none")})})}),e.jsx(E,{children:e.jsx(u,{className:"mr-2",onClick:()=>o(null),children:s("AccountSelect:noMode.back")})})]}):null]})}function je(t){const{usr:s}=t,{t:n,i18n:l}=R(O.get(),{i18n:V}),[r,c]=ee.useState(!1);if(!s||!s.id||!s.id.length)return null;const[a,o]=h.useState(!1);return h.useEffect(()=>{s&&s.id&&s.id.length&&o(!1)},[s]),e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"grid grid-cols-1 mt-3",children:[e.jsx(p,{className:"w-full",style:{transform:"scale(0.75)"},children:e.jsx(g,{children:e.jsx(j,{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.jsxs("div",{className:"grid grid-cols-3",children:[e.jsx("div",{className:"col-span-1 pr-3 pt-3",children:e.jsx(pe,{onChange:c,children:r?e.jsx(M,{size:50,name:s.username,extra:"",expression:{eye:"normal",mouth:"open"},colors:["#92A1C6","#146A7C","#F0AB3D","#C271B4","#C20D90"]}):null})}),e.jsxs("div",{className:"col-span-2 pl-3",children:[e.jsx("span",{className:"text-xl",children:s.username}),e.jsx("br",{}),e.jsxs("span",{className:"text-sm",children:[s.chain,e.jsx("br",{}),s.id]})]})]})})})},s.id),e.jsxs(q,{open:a,onOpenChange:d=>{o(d)},children:[e.jsx(G,{asChild:!0,children:e.jsx(u,{className:"h-5 p-3",children:n("CurrentUser:dialogContent.switchAccountChain")})}),e.jsxs(Q,{className:"sm:max-w-[600px] bg-white",children:[e.jsxs(X,{children:[e.jsx(Y,{children:n("CurrentUser:dialogContent.replacingUser")}),e.jsx(Z,{children:n("CurrentUser:dialogContent.selectChainAccount")})]}),e.jsx(ge,{})]})]})]})})}function Ce(t){const{sourceURL:s}=t,{t:n,i18n:l}=R(O.get(),{i18n:V}),r=h.useSyncExternalStore(T.subscribe,T.get,()=>!0),c={backgroundImage:"var(--accent-gradient)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundSize:"400%",backgroundPosition:"0%"};return e.jsxs("div",{className:"container mx-auto mt-5 mb-5",children:[e.jsx("div",{className:"grid grid-cols-1 mt-5",children:r&&r.username&&r.username.length?e.jsx(je,{usr:r}):null}),e.jsx("div",{className:"grid grid-cols-1 mt-3",children:e.jsxs("h4",{class:"text-center",children:[e.jsxs("a",{style:c,href:s,children:["MIT ",n("PageFooter:licensed")]})," ",n("PageFooter:built")," ",e.jsx("a",{style:c,href:"https://astro.build/",children:"Astro"}),","," ",e.jsx("a",{style:c,href:"https://react.dev/",children:"React"}),","," ",e.jsx("a",{style:c,href:"https://elysiajs.com/",children:"ElysiaJS"})," ","&"," ",e.jsx("a",{style:c,href:"https://bun.sh/",children:"Bun"}),"."]})})]})}export{Ce as default};
