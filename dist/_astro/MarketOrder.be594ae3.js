import{u as e,I as R}from"./button.b901bdd6.js";import{r}from"./index.33c77f1d.js";import{u as L,F as z,a as T,b as F,c as $,d as B,f as H,e as S}from"./form.b6e565ad.js";import{$ as E,m as v,n as N,o as D,p as y,u as J,C as O,b as V,c as q,d as G,k as K,A as Q,I as A,f as W}from"./CurrentUser.f9848bfe.js";import"./avatar.b60ea8a4.js";import{h as X,t as Y,e as Z}from"./common.bc86bc21.js";import{c as ee}from"./User.89aadead.js";import{D as se}from"./DeepLinkDialog.523b36e7.js";import"./index.2e44db93.js";import"./ExternalLink.adef43a2.js";function pe(re){const u=L({defaultValues:{account:""}}),[w,p]=r.useState(!1);r.useState();const[m,te]=r.useState(),[n,ae]=r.useState(),[d,ne]=r.useState(0),s=r.useSyncExternalStore(E.subscribe,E.get,()=>!0),h=r.useSyncExternalStore(v.subscribe,v.get,()=>!0),f=r.useSyncExternalStore(N.subscribe,N.get,()=>!0),x=r.useSyncExternalStore(D.subscribe,D.get,()=>!0),b=r.useSyncExternalStore(y.subscribe,y.get,()=>!0),a=r.useMemo(()=>s&&s.chain?s.chain:"bitshares",[s]);J(a??"bitshares",["assets","globalParams"]);const j=r.useMemo(()=>a&&(h||f)?a==="bitshares"?h:f:[],[h,f,a]),o=r.useMemo(()=>a&&(x||b)?a==="bitshares"?x:b:[],[x,b,a]),[g,k]=r.useState(0);r.useEffect(()=>{if(o&&o.length){const t=o.find(l=>l[0]===0),C=X(t[1].fee,5);k(C)}},[o]);const[P,oe]=r.useState(0),[ie,U]=r.useState();r.useEffect(()=>{let t;return s&&s.id&&(t=ee([s.chain,s.id]).subscribe(({data:l,error:I,loading:M})=>{l&&!I&&!M&&U(l)})),()=>{t&&t()}},[s,P]);const[i,_]=r.useState(),c=r.useMemo(()=>n?j.filter(t=>t.symbol===n):[],[n,j]);return r.useEffect(()=>{c&&c.length&&_(c[0])},[c]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"container mx-auto mt-5 mb-5",children:[e.jsx("div",{className:"grid grid-cols-1 gap-3",children:e.jsxs(O,{children:[e.jsxs(V,{children:[e.jsx(q,{children:"Transfer assets"}),e.jsxs(G,{children:[e.jsx("p",{children:"Send funds from an account you control to another BitShares account holder."}),e.jsxs("p",{className:"mt-1",children:["⛔ Doesn't yet support a memo, so don't use this form when transfering to external services.",e.jsx("br",{}),"✅ Use for simple transfers between accounts."]})]})]}),e.jsxs(K,{children:[e.jsx(z,{...u,children:e.jsxs("form",{onSubmit:()=>{p(!0),event.preventDefault()},children:[e.jsx(T,{control:u.control,name:"account",render:({field:t})=>e.jsxs(F,{children:[e.jsx($,{children:"Sending account"}),e.jsx(B,{children:e.jsxs("div",{className:"grid grid-cols-8 gap-2",children:[e.jsx("div",{className:"col-span-1 ml-5",children:e.jsx(Q,{size:40,name:s&&s.username?s.username:"x",extra:"Sender",expression:{eye:"normal",mouth:"open"},colors:["#92A1C6","#146A7C","#F0AB3D","#C271B4","#C20D90"]})}),e.jsx("div",{className:"col-span-7",children:e.jsx(A,{disabled:!0,placeholder:"Bitshares account (1.2.x)",className:"mb-1 mt-1",value:`${s&&s.username?s.username:"?"} (${s&&s.id?s.id:"?"})`})})]})}),e.jsx(H,{children:"This is the account that owns the market order which is being updated."}),e.jsx(S,{})]})}),e.jsx(T,{control:u.control,name:"networkFee",render:({field:t})=>e.jsxs(F,{children:[e.jsx($,{children:"Network fee"}),e.jsx(B,{children:e.jsx(A,{disabled:!0,placeholder:`${g} BTS`,className:"mb-3 mt-3"})}),s.id===s.referrer?e.jsxs(S,{children:["Rebate: ",Y(g*.8,5)," BTS (vesting)"]}):null,e.jsx(S,{})]})}),e.jsx(R,{className:"mt-5 mb-3",variant:"outline",type:"submit",children:"Submit"})]})}),w?e.jsx(se,{operationName:"transfer",username:s.username,usrChain:s.chain,userID:s.id,dismissCallback:p,headerText:`Sending ${d} ${i.symbol} (${i.id}) to ${m.name} from ${s.username}`,trxJSON:[{fee:{amount:0,asset_id:"1.3.0"},from:s.id,to:m.id,amount:{amount:Z(d,i.precision).toFixed(0),asset_id:i.id},extensions:[]}]},`Sending${d}${n}to${m.name}from${s.username}`):null]})]})}),e.jsx("div",{className:"grid grid-cols-1 mt-5",children:s&&s.username&&s.username.length?e.jsx(W,{usr:s}):null})]})})}export{pe as default};
