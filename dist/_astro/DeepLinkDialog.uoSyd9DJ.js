import{j as e,c as m,u as O,l as v,d as J,s as $,a as F,i as E}from"./utils.7znXe2qs.js";import{r as i}from"./index.sXsv9c-e.js";import{n as R,l as B}from"./Init.SOFaEcmE.js";import{T as _,a as M,b as x,c as D,f as q}from"./common.D-iicPwN.js";import{b as A,_ as P}from"./index.zSBU31wW.js";import{c as U,B as c}from"./button.aE--GSfB.js";import{E as X}from"./ExternalLink.-MmVvsi5.js";import{D as H,a as I,b as W,c as z,d as G}from"./dialog.ty4DDuUr.js";const K=i.forwardRef((s,n)=>i.createElement(A.label,P({},s,{ref:n,onMouseDown:a=>{var l;(l=s.onMouseDown)===null||l===void 0||l.call(s,a),!a.defaultPrevented&&a.detail>1&&a.preventDefault()}}))),u=K,Q=U("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=i.forwardRef(({className:s,...n},a)=>e.jsx(u,{ref:a,className:m(Q(),s),...n}));d.displayName=u.displayName;const f=i.forwardRef(({className:s,...n},a)=>e.jsx("textarea",{className:m("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),ref:a,...n}));f.displayName="Textarea";let j=[];const[V]=R({fetcher:(...s)=>fetch(`http://localhost:8080/api/deeplink/${s[0]}/${s[1]}`,{method:"POST",body:JSON.stringify(j)}).then(async n=>{if(!n.ok)throw console.log("Failed to generate deeplink"),new Error("Failed to generate deeplink");let a;try{a=await n.json()}catch{throw console.log("Failed to parse JSON"),new Error("Failed to parse JSON")}return a}).then(n=>{if(n&&n.result){const a=J($(n.result,!0)),l=F(a),r=JSON.parse(l);if(r.generatedDeepLink)return r.generatedDeepLink}throw new Error("No deep link generated")})});function oe(s){const{trxJSON:n,operationName:a,usrChain:l,headerText:r,dismissCallback:k,username:L,userID:N}=s,{t,i18n:Y}=O(v.get(),{i18n:E}),C=i.useMemo(()=>(j=n,V([l,a])),[l,a,n]),{data:b,loading:o,error:w}=B(C),[p,h]=i.useState(!1),y=()=>{p||(h(!0),setTimeout(()=>{h(!1)},1e4))},[T,g]=i.useState("object");return e.jsx(H,{open:!0,onOpenChange:S=>{k(S)},children:e.jsxs(I,{className:"sm:max-w-[800px] bg-white",children:[e.jsxs(W,{children:[e.jsx(z,{children:o?t("DeepLinkDialog:dialogContent.generatingDeeplink"):e.jsx(e.Fragment,{children:r})}),e.jsxs(G,{children:[t("DeepLinkDialog:dialogContent.withAccount",{username:L,userID:N}),o?null:e.jsxs(e.Fragment,{children:[t("DeepLinkDialog:dialogContent.readyToBroadcast"),e.jsx("br",{}),t("DeepLinkDialog:dialogContent.chooseMethod")," ",e.jsx(X,{classnamecontents:"text-blue-500",type:"text",text:t("DeepLinkDialog:dialogContent.beetWallet"),hyperlink:"https://github.com/bitshares/beet"})]}),w?t("DeepLinkDialog:dialogContent.errorOccurred"):null]})]}),e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"mt-3"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:e.jsxs(_,{defaultValue:"object",className:"w-full",children:[e.jsxs(M,{className:"grid w-full grid-cols-3 gap-2",children:[e.jsx(x,{value:"object",onClick:()=>g("object"),children:t("DeepLinkDialog:tabs.viewTRXObject")},"TRXTab"),e.jsx(x,{value:"deeplink",onClick:()=>g("deeplink"),children:t("DeepLinkDialog:tabs.rawDeeplink")},"DLTab"),e.jsx(x,{value:"localJSON",onClick:()=>g("localJSON"),children:t("DeepLinkDialog:tabs.localJSONFile")},"JSONTab")]},`${T}_TabList`),e.jsxs(D,{value:"object",children:[e.jsxs("div",{className:"grid w-full gap-1.5 mb-3",children:[e.jsx(d,{className:"text-left",children:t("DeepLinkDialog:tabsContent.transactionObjectJSON")}),e.jsx("span",{className:"text-left text-sm",children:t("DeepLinkDialog:tabsContent.operationType",{operationName:a})}),e.jsx(f,{value:JSON.stringify(n,null,4),className:"min-h-[250px]",id:"trxJSON",readOnly:!0})]}),e.jsx(c,{onClick:()=>{q(JSON.stringify(n,null,4))},children:t("DeepLinkDialog:tabsContent.copyOperationJSON")})]}),e.jsxs(D,{value:"deeplink",children:[e.jsx(d,{className:"text-left",children:t("DeepLinkDialog:tabsContent.usingDeeplink")}),e.jsxs("ol",{className:"ml-4",children:[e.jsx("li",{type:"1",children:t("DeepLinkDialog:tabsContent.step1")}),e.jsx("li",{type:"1",children:t("DeepLinkDialog:tabsContent.step2",{operationName:a})}),e.jsx("li",{type:"1",children:t("DeepLinkDialog:tabsContent.step3")}),e.jsx("li",{type:"1",children:t("DeepLinkDialog:tabsContent.step4")}),e.jsx("li",{type:"1",children:t("DeepLinkDialog:tabsContent.step5")})]}),o?null:e.jsx("a",{href:`rawbeet://api?chain=${l==="bitshares"?"BTS":"BTS_TEST"}&request=${b}`,children:e.jsx(c,{className:"mt-4",children:t("DeepLinkDialog:tabsContent.triggerRawBeet")})})]}),e.jsxs(D,{value:"localJSON",children:[e.jsx(d,{className:"text-left",children:t("DeepLinkDialog:tabsContent.viaLocalFile")}),e.jsxs("ol",{className:"ml-4",children:[e.jsx("li",{type:"1",children:t("DeepLinkDialog:tabsContent.step1Local")}),e.jsx("li",{type:"1",children:t("DeepLinkDialog:tabsContent.step2Local",{operationName:a})}),e.jsx("li",{type:"1",children:t("DeepLinkDialog:tabsContent.step3Local")}),e.jsx("li",{type:"1",children:t("DeepLinkDialog:tabsContent.step4Local")}),e.jsx("li",{type:"1",children:t("DeepLinkDialog:tabsContent.step5Local")})]}),!o&&p?e.jsx(c,{className:"mt-4",variant:"outline",disabled:!0,children:t("DeepLinkDialog:tabsContent.downloading")}):null,!o&&!p?e.jsx("a",{href:`data:text/json;charset=utf-8,${b}`,download:`${a}.json`,target:"_blank",rel:"noreferrer",onClick:y,children:e.jsx(c,{className:"mt-4",children:t("DeepLinkDialog:tabsContent.downloadBeetOperationJSON")})}):null]})]})})]})]})})}export{oe as D,d as L};
